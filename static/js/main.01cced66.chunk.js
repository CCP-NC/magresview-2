(this["webpackJsonpmagresview-2"]=this["webpackJsonpmagresview-2"]||[]).push([[0],{129:function(e,t,n){},191:function(e,t,n){},192:function(e,t,n){},193:function(e,t,n){},206:function(e,t){},254:function(e,t,n){},255:function(e,t,n){},257:function(e,t,n){},258:function(e,t,n){},259:function(e,t,n){},260:function(e,t,n){},261:function(e,t,n){},262:function(e,t,n){},263:function(e,t,n){},265:function(e,t,n){},266:function(e,t,n){},267:function(e,t,n){},268:function(e,t,n){},269:function(e,t,n){},270:function(e,t,n){},271:function(e,t,n){},272:function(e,t,n){},273:function(e,t,n){},274:function(e,t,n){},275:function(e,t,n){},276:function(e,t,n){},277:function(e,t,n){},278:function(e,t,n){},279:function(e,t,n){},385:function(e,t,n){},387:function(e,t,n){"use strict";n.r(t);var a=n(3),s=n.n(a),i=n(48),c=n.n(i),l=(n(191),n(14)),r=(n(192),n(74),n(193),n(10)),o=n.n(r);function d(){return o.a.join(o.a.flatten(arguments)," ")}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"uid",t=Object(a.useState)((function(){return o.a.uniqueId(e)})),n=Object(l.a)(t,1),s=n[0];return s}var h=n(4),p=n(5),f=n(87),b=n.n(f),j=n(88),m=n.n(j),v=function(){function e(t,n){Object(h.a)(this,e),this._callback=n,this._n=t,this._arg={}}return Object(p.a)(e,[{key:"call",value:function(e){if(this._n<=0)throw Error("CallbackMerger has completed its iterations");o.a.merge(this._arg,e),this._n-=1,0===this._n&&this._callback(this._arg)}}]),e}(),_=Object(p.a)((function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(h.a)(this,e),Array.isArray(n)&&(n=o.a.fromPairs(n.map((function(e,t){return[e,t]}))));var a=function(e){var a=n[e];Object.defineProperty(t,e,{get:function(){return a}})};for(var s in n)a(s)}));function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return e.reduce((function(e,a){a=Number.isFinite(a)&&!Number.isInteger(a)?a.toFixed(n):a.toString();var s=t-a.length;return e+" ".repeat(s>0?s:0)+a}),"")+"\n"}function g(e,t){var n=document.createElement("a");n.setAttribute("download",t),n.setAttribute("href",e),n.click()}var y=n(161),x=Object(y.a)({float:new RegExp("[0-9]*(?:[.][0-9]*)?"),int:new RegExp("[0-9]*"),alpha:new RegExp("[a-zA-Z]*"),alphanumeric:new RegExp("[0-9a-zA-Z]*")});function k(e,t){var n=e.isotopeData.gamma||0,a=t.isotopeData.gamma||0,s=e.xyz,i=t.xyz.map((function(e,t){return e-s[t]})),c=Math.sqrt(i.reduce((function(e,t){return e+t*t}),0)),l=i.map((function(e){return e/c}));return[-1.3252140307214143e-10*n*a/(8*Math.PI*Math.PI*Math.pow(c,3)),l]}function w(e,t){var n;try{n=e.getArrayValue("isc")[t.index]}catch(i){return null}if(!n)return null;var a=e.isotopeData.gamma,s=t.isotopeData.gamma;return(n=n.iscAtomicToHz(a,s)).isotropy}var S=n(395);function E(e,t){return S.a(t,S.b(e))}function C(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"zyz",a=e[2][2];a=Math.min(Math.max(a,-1),1);var s,i=Math.acos(a);if(1===Math.abs(a))s=0,t=Math.atan2(e[0][1],e[0][0]);else switch(n){case"zyz":t=Math.atan2(e[2][1],e[2][0]),s=Math.atan2(e[1][2],-e[0][2]);break;case"zxz":t=Math.atan2(e[2][0],-e[2][1]),s=Math.atan2(e[0][2],e[1][2]);break;default:throw Error("Unrecognised Euler angles convention")}return[t,i,s]}function L(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"zyz",a=e.haeberlen_eigenvectors,s=t.haeberlen_eigenvectors;return C(E(a,s),n)}var N=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(h.a)(this,e),this._callbacks={};var a=this;n.forEach((function(e){a._callbacks[e]={},t.onAtomClick((function(t,n){var s=a._callbacks[e];for(var i in s)s[i](t,n)}),e)}))}return Object(p.a)(e,[{key:"setCallback",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!(t in this._callbacks))throw Error("Invalid callback code; unsupported event type");n?this._callbacks[t][e]=n:delete this._callbacks[t][e]}}]),e}(),I=n(15),A=n(16),M=n(13),R=n(166),D=n(8),F=n(9),T=n(24);function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(n){var a={};for(var s in n)(o.a.startsWith(s,e)||-1!==t.indexOf(s))&&(a[s]=n[s]);return a}return n}var z=function(e,t){return e+"_"+t};function B(e){var t=e.selected;return t?t.length>0?t:e.displayed:null}function G(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ms",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s="",i={ms:"ppm",efg:"au"}[n],c=null,l=e.map((function(e){return e.getArrayValue(n)}));switch(t){case"iso":c=l.map((function(e){return e.isotropy})),s=i;break;case"aniso":c=l.map((function(e){return e.anisotropy})),s=i;break;case"redaniso":c=l.map((function(e){return e.reduced_anisotropy})),s=i;break;case"asymm":c=l.map((function(e){return e.asymmetry}));break;case"span":c=l.map((function(e){return e.span}));break;case"skew":c=l.map((function(e){return e.skew}));break;case"cs":if(!a)throw Error("Can not compute chemical shifts without a reference table");c=l.map((function(t,n){var s=e.atoms[n].element;return(a[s]||0)-t.isotropy})),s=i;break;case"e_x":c=l.map((function(e){return e.haeberlen_eigenvalues[0]}));break;case"e_y":c=l.map((function(e){return e.haeberlen_eigenvalues[1]}));break;case"e_z":c=l.map((function(e){return e.haeberlen_eigenvalues[2]}));break;case"Q":c=l.map((function(t,n){var a=e.atoms[n].isotopeData;return t.efgAtomicToHz(a.Q).haeberlen_eigenvalues[2]/1e6})),s="MHz"}return[s,c]}function V(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if("MHz"===t){if(e<0)return"-"+V(-e,t,n);if(e<1e-8)return"";e<1&&e>.001?(e*=1e3,t="kHz",n=Math.max(0,n-3)):e<.001&&e>1e-8&&(e*=1e6,t="Hz",n=Math.max(0,n-6))}return e.toFixed(n)+" "+t}var J=function(){function e(t,n){Object(h.a)(this,e),this._state=t,this._dispatcher=n}return Object(p.a)(e,[{key:"state",get:function(){return this._state}},{key:"dispatch",value:function(e){this._dispatcher(e)}}]),e}(),K=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"hasModel",get:function(){return this.state.app_viewer&&this.state.app_viewer.model}},{key:"hasMSData",get:function(){var e=this.state.app_viewer;return e&&e.model&&e.model.hasArray("ms")}},{key:"hasEFGData",get:function(){var e=this.state.app_viewer;return e&&e.model&&e.model.hasArray("efg")}},{key:"hasISCData",get:function(){var e=this.state.app_viewer;return e&&e.model&&e.model.hasArray("isc")}}]),n}(J);var q=16744448,W=33023;function H(e,t){var n=z(e,"view"),a=z(e,"ellipsoids_on"),s=z(e,"ellipsoids_scale");return function(i){var c,l=i.app_viewer,r=i[n],d=B(l),u=i[a],h=i[s];if(!r||r===d&&u||r.removeEllipsoids(e),u){var p=d.map((function(t){return t.getArrayValue(e)}));if(0===h){var f=p.map((function(e){return o.a.sum(e.eigenvalues.map(Math.abs))/3}));h=2/(f=o.a.sum(f)/p.length)}d.addEllipsoids(p,e,{scalingFactor:h,color:t,opacity:.125})}return c={},Object(A.a)(c,n,d),Object(A.a)(c,s,h),c}}var Z=H("ms",q),U=H("efg",W);function Q(e,t,n){var a=z(e,"view"),s=z(e,"references"),i=z(e,"labels_type");return function(c){var r,o=c.app_viewer,d=c[a],u=c[s],h=B(o),p=c[i];if(!d||d===h&&"none"!==p||d.removeLabels(e),"none"!==p){if("sel_sites"!==e){var f=G(h,p,e,u),b=Object(l.a)(f,2),j=b[0],m=b[1],v=c[z(e,"precision")];r=m.map((function(e){return V(e,j,v)}))}else"element"===p?r=h.atoms.map((function(e){return e.element})):"isotope"===p?r=h.atoms.map((function(e){return e.isotope+e.element})):"labels"===p&&(r=h.atoms.map((function(e){return e.crystLabel})));h.addLabels(r,e,(function(e,a){return{color:t,shift:n(e.radius),height:.02}}))}return Object(A.a)({},a,h)}}var Y=Q("sel_sites",16777215,(function(e){return[e,e,0]})),X=Q("ms",q,(function(e){return[1.414*e,0,0]})),$=Q("efg",W,(function(e){return[e,-e,0]}));function ee(e){var t=z(e,"links_on"),n=z(e,"central_atom"),a=z(e,"radius"),s=z(e,"homonuclear"),i=z(e,"view");return function(c){var l,r=c.app_viewer.model;if(!r)return{};var o,d=Object(M.a)({},c.sel_ghosts_requests),u=c[t],h=c[n],p=c[a],f=c[s];if(u&&h){var b={sphere:[h,p]};f&&(b={$and:[b,{elements:[h.element]}]}),o=r.find(b),d[e]=o}else o=r.view([]),delete d[e];return l={},Object(A.a)(l,i,o),Object(A.a)(l,"sel_ghosts_requests",d),l}}function te(e,t){var n=z(e,"links_on"),a=z(e,"central_atom"),s=z(e,"radius"),i=z(e,"sphere_show"),c=z(e,"view"),l=[];return function(r){var o=r.app_viewer,d=r[c],u=r[a],h=r[s],p=r[n],f=r[i],b=o.model;if(!b)return{};l.forEach((function(e){b.removeGraphics(e)}));var j=r[z(e,"precision")];return l=[],p&&u&&d&&d.atoms.forEach((function(n,a){if(n!==u){var s=e+"_link_"+a,i=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;switch(n){case"dip":return(k(e,t)[0]/1e3).toFixed(a)+" kHz";case"jc":var s=w(e,t);return null===s?"":s.toFixed(a)+" Hz";default:return""}}(u,n,e,j);""!==i&&(b.addLink(u,n,s,i,{color:t,dashed:!0,onOverlay:!0}),l.push(s))}})),p&&u&&f?b.addSphere(u.xyz,h,e+"_sphere",{opacity:.25,showAxes:!1,showCircles:!0}):b.removeGraphics(e+"_sphere"),{}}}var ne=ee("dip"),ae=te("dip",65408),se=ee("jc"),ie=te("jc",16711808),ce={ms:q,efg:W};var le=new _(["DISPLAY","VIEWS","SEL_LABELS","CELL","CSCALE","MS_ELLIPSOIDS","MS_LABELS","EFG_ELLIPSOIDS","EFG_LABELS","EUL_ANGLES","DIP_LINKS","DIP_RENDER","JC_LINKS","JC_RENDER","PLOTS_RECALC"]),re={0:new Set([le.DISPLAY]),1:new Set([le.SEL_LABELS,le.CELL,le.CSCALE,le.MS_ELLIPSOIDS,le.MS_LABELS,le.EFG_ELLIPSOIDS,le.EFG_LABELS,le.EUL_ANGLES,le.PLOTS_RECALC,le.DIP_RENDER,le.JC_RENDER]),2:new Set([le.VIEWS]),3:new Set([le.DIP_LINKS,le.JC_LINKS])};function oe(e){for(var t in re){if(re[t].has(e))return t}return 0}var de,ue=le,he=(de={},Object(A.a)(de,ue.DISPLAY,(function(e){var t=e.app_viewer,n=e.app_model_queued,a={};return t&&n&&(t.displayModel(n),a={app_default_displayed:t.displayed,app_model_queued:null}),a})),Object(A.a)(de,ue.VIEWS,(function(e){var t=e.app_viewer,n=t.model;if(!n)return{};var a=e.sel_selected_view,s=e.sel_displayed_view?e.sel_displayed_view:e.app_default_displayed;return a&&a!==t.selected&&(t.selected=a),n&&n.all.hide(),Object.values(e.sel_ghosts_requests).forEach((function(e,t){e.show(),e.setProperty("opacity",.5)})),t.displayed=s,s.setProperty("opacity",1),{}})),Object(A.a)(de,ue.SEL_LABELS,Y),Object(A.a)(de,ue.CELL,(function(e){var t=e.app_viewer;if(t){var n=t.model;n&&(n.box.visible=e.sel_show_cell,n.axes.visible=e.sel_show_cell)}return{}})),Object(A.a)(de,ue.CSCALE,(function(e){var t=e.app_viewer,n=e.cscale_view,a=e.cscale_displ,s=t.displayed,i=B(t),c=null,r=e.cscale_type,d=e.cscale_cmap;if(a&&a.setProperty("color",null),"none"!==r){var u=r.match(/^([^_]*)_(.*)$/),h=Object(l.a)(u,3),p=h[1],f=h[2],j=e[p+"_references"];c=s.xor(i);var v=G(i,f,p,j),_=v[1];"efg_Q"===r&&_.forEach((function(e,t){return _[t]=Math.abs(e)}));var O=o.a.min(_),g=o.a.max(_),y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"jet",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,s=b()({colormap:n,nshades:a,format:"hex",alpha:1});return t=t===e?t+1e-8:t,new m.a(e,t,s,1)}(O,g,d),x=_.map((function(e){return y.getColor(e).toHexString()}));e.cscale_lims=[O,g],e.cscale_units=v[0],i.setProperty("color",x),c.setProperty("color",8947848)}else n&&n.setProperty("color",null);return{cscale_view:i,cscale_displ:c}})),Object(A.a)(de,ue.MS_ELLIPSOIDS,Z),Object(A.a)(de,ue.MS_LABELS,X),Object(A.a)(de,ue.EFG_ELLIPSOIDS,U),Object(A.a)(de,ue.EFG_LABELS,$),Object(A.a)(de,ue.EUL_ANGLES,(function(e){var t=e.eul_atom_A,n=e.eul_atom_B,a=e.eul_newatom_A,s=e.eul_newatom_B,i=e.eul_tensor_A,c=e.eul_tensor_B,l=e.eul_convention,r=null,o=null;if(t&&t.removeLabel("eulA"),a){var d=a.radius;a.addLabel("A","eulA",{shift:[0,.25*d,0],color:ce[i],onOverlay:!0,height:.04}),a.model.hasArray(i)&&(r=a.getArrayValue(i))}if(n&&n.removeLabel("eulB"),s){var u=s.radius;s.addLabel("B","eulB",{shift:[0,-.5*u,0],color:ce[c],onOverlay:!0}),s.model.hasArray(c)&&(o=s.getArrayValue(c))}var h=null;return r&&o&&(h=L(r,o,l)),{eul_atom_A:a,eul_atom_B:s,eul_results:h}})),Object(A.a)(de,ue.PLOTS_RECALC,(function(e){var t=parseFloat(e.plots_min_x),n=parseFloat(e.plots_max_x),a=parseFloat(e.plots_min_y),s=parseFloat(e.plots_max_y),i=B(e.app_viewer),c=e.ms_references,l=e.plots_use_refs?"cs":"iso",r=!i;if(r=(r=r||isNaN(t)||isNaN(n)||isNaN(a)||isNaN(s))||"none"===e.plots_mode)return{plots_data:[]};var d=[],u=[],h=parseFloat(e.plots_peak_width),p=parseInt(e.plots_x_steps),f=G(i,l,"ms",c)[1],b=i.atoms.map((function(e){return e.crystLabel})),j=f.filter((function(e){return e+h>=t&&e-h<=n})),m=b.filter((function(e,t){return j.indexOf(f[t])>=0}));if(m.length!==j.length)throw Error("Mismatch between labels and peaks");var v=o.a.zip(j,m).sort((function(e,t){return e[0]-t[0]})),_=v.map((function(e){return e[0]})),O=v.map((function(e){return e[1]}));switch(e.plots_mode){case"bars-1d":u=(d=_).map((function(){return.75*s}));break;case"line-1d":d=o.a.range(p).map((function(e){return t+(n-t)*e/(p-1)})),u=d.map((function(e){return _.reduce((function(t,n){return t+function(e,t,n){return.5/Math.PI*n/(Math.pow(e-t,2)+.25*n*n)}(e,n,h)}),0)}))}return{plots_data:[{id:"Curve",data:d.map((function(e,t){return{x:e,y:u[t]}})),peaks:_||[],labels:O||[]}]}})),Object(A.a)(de,ue.DIP_LINKS,ne),Object(A.a)(de,ue.DIP_RENDER,ae),Object(A.a)(de,ue.JC_LINKS,se),Object(A.a)(de,ue.JC_RENDER,ie),de);var pe=function(e){return function(){var t=e.getState(),n=t.listen_update;if(n&&n.length>0){var a={},s=n.reduce((function(e,t){var n=oe(t);return n>e?n:e}),-1);n=n.filter((function(e){return oe(e)===s})),(n=new Set(n)).forEach((function(e){if(e in he)try{var n=he[e](t);a=Object(M.a)(Object(M.a)({},a),n)}catch(s){console.warn(s)}}));var i=[];s>0&&(i=Object(I.a)(re[s-1])),a.listen_update=i,e.dispatch({type:"update",data:a})}}},fe=n(29),be=fe.a.LEFT_CLICK,je=fe.a.LEFT_CLICK+fe.a.SHIFT_BUTTON,me=fe.a.LEFT_CLICK+fe.a.CTRL_BUTTON,ve={sel_selected_view:null,sel_displayed_view:null,sel_ghosts_requests:{},sel_on:!1,sel_mode:"atom",sel_sphere_r:2,sel_bond_n:1,sel_hlight:!0,sel_sites_view:null,sel_sites_labels_type:"none",sel_show_cell:!0},_e=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"app",get:function(){return this.state.app_viewer}},{key:"selected",get:function(){return this.state.sel_selected_view},set:function(e){if(!e){var t=this.state.app_viewer.model;t&&(e=t.view([]))}this.dispatch({type:"update",data:{sel_selected_view:e,listen_update:[ue.VIEWS]}})}},{key:"displayed",get:function(){return this.state.sel_displayed_view||this.state.app_default_displayed},set:function(e){(e||(e=this.state.app_default_displayed))&&this.dispatch({type:"update",data:{sel_displayed_view:e,listen_update:[ue.VIEWS]}})}},{key:"defaultDisplayed",get:function(){return this.state.app_default_displayed}},{key:"highlightSelected",get:function(){return this.state.sel_hlight},set:function(e){var t=this.state.app_viewer;t&&(t.highlightSelected=e,this.dispatch({type:"set",key:"sel_hlight",value:e}))}},{key:"labelMode",get:function(){return this.state.sel_sites_labels_type},set:function(e){this.dispatch({type:"update",data:{sel_sites_labels_type:e,listen_update:[ue.SEL_LABELS]}})}},{key:"showCell",get:function(){return this.state.sel_show_cell},set:function(e){this.dispatch({type:"update",data:{sel_show_cell:e,listen_update:[ue.CELL]}})}},{key:"selectionOn",get:function(){return this.state.sel_on},set:function(e){this.setSelection(this.selectionMode,{on:e})}},{key:"selectionMode",get:function(){return this.state.sel_mode},set:function(e){this.setSelection(e)}},{key:"selectionSphereR",get:function(){return this.state.sel_sphere_r},set:function(e){this.setSelection(this.selectionMode,{r:e})}},{key:"selectionBondN",get:function(){return this.state.sel_bond_n},set:function(e){this.setSelection(this.selectionMode,{n:e})}},{key:"isotopeChoices",get:function(){var e=this.selected;if(null===e)return null;var t=e.map((function(e,t){return e.element})),n=t[0];if(!t.reduce((function(e,t){return e&&t===n}),!0))return null;var a=e.atoms[0].elementData;return Object.keys(a.isotopes).sort().map((function(e,t){var n=a.isotopes[e];return{A:e,is_nmr_active:0!==n.spin,is_Q_active:0!==n.Q,is_max_nmr:e===a.maxiso_NMR,is_max_Q:e===a.maxiso_Q,abundance:n.abundance}}))}},{key:"setIsotope",value:function(e){var t=this.selected;if(null===t)return null;t.setProperty("isotope",e),this.dispatch({type:"update",data:{listen_update:[ue.EFG_LABELS,ue.CSCALE,ue.DIP_RENDER,ue.JC_RENDER,ue.SEL_LABELS]}})}},{key:"setSelection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.state.app_viewer;if(n){var a={r:this.selectionSphereR,n:this.selectionBondN,on:this.selectionOn};t=Object(M.a)(Object(M.a)({},a),t);var s=null;if(t.on)switch(e){case"atom":s=function(e,t){return n.model.view([e.imgIndex])};break;case"element":s=function(e,t){var a=n.model._queryElements(e.element);return n.model.view(a)};break;case"label":s=function(e,t){var a=n.model._queryLabels([e.crystLabel]);return n.model.view(a)};break;case"sphere":var i=t.r;s=function(e,t){var a=n.model._querySphere(e,i);return n.model.view(a)};break;case"molecule":s=function(e,t){var a=n.model._queryMolecule(e);return n.model.view(a)};break;case"bonds":var c=t.n;s=function(e,t){var a=n.model._queryBonded(e,c,!1);return a=a.concat([e.imgIndex]),n.model.view(a)}}var l=this.state.app_default_displayed,r=this,o=this.state.app_click_handler;s?(o.setCallback("sel",be,(function(e,t){r.selected=l.and(s(e,t))})),o.setCallback("sel",je,(function(e,t){r.selected=l.and(n.selected.or(s(e,t)))})),o.setCallback("sel",me,(function(e,t){r.selected=l.and(n.selected.xor(s(e,t)))}))):(o.setCallback("sel",be),o.setCallback("sel",je),o.setCallback("sel",me)),this.dispatch({type:"update",data:{sel_mode:e,sel_sphere_r:t.r,sel_bond_n:t.n,sel_on:t.on}})}}}]),n}(J);var Oe=function(){var e=Object(T.d)(P("sel",["app_viewer","app_click_handler","app_default_displayed"]),T.b),t=Object(T.c)();return new _e(e,t)},ge={cscale_view:null,cscale_displ:null,cscale_type:"none",cscale_lims:[0,1],cscale_units:"",cscale_cmap:"viridis"},ye=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"colorScaleType",get:function(){return this.state.cscale_type},set:function(e){this.dispatch({type:"update",data:{cscale_type:e,listen_update:[ue.CSCALE]}})}},{key:"colorScalePrefix",get:function(){return this.colorScaleType.split("_",2)[0]}},{key:"colorScaleLimits",get:function(){return this.state.cscale_lims}},{key:"colorScaleUnits",get:function(){return this.state.cscale_units}},{key:"colorScaleCmap",get:function(){return this.state.cscale_cmap},set:function(e){this.dispatch({type:"update",data:{cscale_cmap:e,listen_update:[ue.CSCALE]}})}},{key:"reset",value:function(){this.dispatch({type:"update",data:Object(M.a)(Object(M.a)({},ge),{},{listen_update:[ue.CSCALE]})})}}]),n}(J);function xe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return P(e,t=t.concat(Object.keys(ge)))}var ke=ye,we=n(12),Se=n(11),Ee={ms_view:null,ms_ellipsoids_on:!1,ms_ellipsoids_scale:.05,ms_labels_type:"none",ms_references:{},ms_precision:2};function Ce(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={};return t&&(n=Object(M.a)(Object(M.a)({},e.ms_references),t)),{ms_references:n,listen_update:[ue.MS_LABELS,ue.CSCALE,ue.PLOTS_RECALC]}}var Le=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{type:"update",data:Object(M.a)(Object(M.a)({},e),{},{listen_update:t})}},Ne=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"hasData",get:function(){var e=this.state.app_viewer;return e&&e.model&&e.model.hasArray("ms")}},{key:"hasEllipsoids",get:function(){return this.state.ms_ellipsoids_on},set:function(e){this.dispatch(Le({ms_ellipsoids_on:e},[ue.MS_ELLIPSOIDS]))}},{key:"ellipsoidScale",get:function(){return this.state.ms_ellipsoids_scale},set:function(e){this.dispatch(Le({ms_ellipsoids_scale:e},[ue.MS_ELLIPSOIDS]))}},{key:"labelsMode",get:function(){return this.state.ms_labels_type},set:function(e){this.dispatch(Le({ms_labels_type:e},[ue.MS_LABELS]))}},{key:"precision",get:function(){return this.state.ms_precision},set:function(e){this.dispatch(Le({ms_precision:e},[ue.MS_LABELS]))}},{key:"colorScaleAvailable",get:function(){var e=this.colorScalePrefix;return"none"===e||"ms"===e}},{key:"referenceTable",get:function(){if(!this.state.app_viewer||!this.state.app_viewer.model)return[];var e=o.a.uniq(this.state.app_viewer.model.symbols),t=this.state.ms_references;return o.a.fromPairs(e.map((function(e){return[e,t[e]||0]})))}},{key:"updateReferenceTable",value:function(e){this.dispatch({type:"call",function:Ce,arguments:[e]})}},{key:"getReference",value:function(e){return this.state.ms_references[e]||0}},{key:"reset",value:function(){Object(we.a)(Object(Se.a)(n.prototype),"reset",this).call(this),this.updateReferenceTable([null]),this.precision=Ee.ms_precision,this.labelsMode=Ee.ms_labels_type,this.hasEllipsoids=Ee.ms_ellipsoids_on,this.ellipsoidScale=Ee.ms_ellipsoids_scale}}]),n}(ke);var Ie=function(){var e=Object(T.d)(xe("ms",["app_viewer","efg_cscale_type"]),T.b),t=Object(T.c)();return new Ne(e,t)},Ae={efg_view:null,efg_ellipsoids_on:!1,efg_ellipsoids_scale:.1,efg_labels_type:"none",efg_precision:2},Me=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{type:"update",data:Object(M.a)(Object(M.a)({},e),{},{listen_update:t})}},Re=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"hasData",get:function(){var e=this.state.app_viewer;return e&&e.model&&e.model.hasArray("efg")}},{key:"hasEllipsoids",get:function(){return this.state.efg_ellipsoids_on},set:function(e){this.dispatch(Me({efg_ellipsoids_on:e},[ue.EFG_ELLIPSOIDS]))}},{key:"ellipsoidScale",get:function(){return this.state.efg_ellipsoids_scale},set:function(e){this.dispatch(Me({efg_ellipsoids_scale:e},[ue.EFG_ELLIPSOIDS]))}},{key:"labelsMode",get:function(){return this.state.efg_labels_type},set:function(e){this.dispatch(Me({efg_labels_type:e},[ue.EFG_LABELS]))}},{key:"precision",get:function(){return this.state.efg_precision},set:function(e){this.dispatch(Me({efg_precision:e},[ue.EFG_LABELS]))}},{key:"colorScaleAvailable",get:function(){var e=this.colorScalePrefix;return"none"===e||"efg"===e}},{key:"reset",value:function(){Object(we.a)(Object(Se.a)(n.prototype),"reset",this).call(this),this.dispatch(Me({efg_ellipsoids_scale:Ae.efg_ellipsoids_scale},[ue.CSCALE])),this.hasEllipsoids=Ae.efg_ellipsoids_on,this.labelsMode=Ae.efg_labels_type,this.precision=Ae.efg_precision}}]),n}(ke);var De=function(){var e=Object(T.d)(xe("efg",["app_viewer","ms_cscale_type"]),T.b),t=Object(T.c)();return new Re(e,t)},Fe=fe.a.LEFT_CLICK,Te={dip_view:null,dip_link_names:[],dip_links_on:!1,dip_central_atom:null,dip_radius:1.5,dip_sphere_show:!0,dip_homonuclear:!1,dip_precision:2},Pe=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"isOn",get:function(){return this.state.dip_links_on},set:function(e){var t={dip_links_on:e,listen_update:[ue.DIP_LINKS]};e||(t.dip_central_atom=null),this.dispatch({type:"update",data:t})}},{key:"centralAtom",get:function(){return this.state.dip_central_atom}},{key:"radius",get:function(){return this.state.dip_radius},set:function(e){this.dispatch({type:"update",data:{dip_radius:e}})}},{key:"homonuclearOnly",get:function(){return this.state.dip_homonuclear},set:function(e){this.dispatch({type:"update",data:{dip_homonuclear:e,listen_update:[ue.DIP_LINKS]}})}},{key:"showSphere",get:function(){return this.state.dip_sphere_show},set:function(e){this.dispatch({type:"update",data:{dip_sphere_show:e,listen_update:[ue.DIP_RENDER]}})}},{key:"precision",get:function(){return this.state.dip_precision},set:function(e){this.dispatch({type:"update",data:{dip_precision:e,listen_update:[ue.DIP_LINKS]}})}},{key:"reset",value:function(){this.isOn=Te.dip_links_on,this.showSphere=Te.dip_sphere_show,this.precision=Te.dip_precision,this.homonuclearOnly=Te.dip_homonuclear,this.radius=Te.dip_radius}},{key:"bind",value:function(){var e=this._dispatcher,t=this.state.app_click_handler;t&&t.setCallback("dip",Fe,(function(t,n){t.opacity<1||e({type:"update",data:{dip_central_atom:t,listen_update:[ue.DIP_LINKS]}})}))}},{key:"unbind",value:function(){var e=this.state.app_click_handler;e&&e.setCallback("dip",Fe)}}]),n}(J);var ze=function(){var e=Object(T.d)(P("dip",["app_click_handler"]),T.b),t=Object(T.c)();return new Pe(e,t)},Be=fe.a.LEFT_CLICK,Ge={jc_view:null,jc_link_names:[],jc_links_on:!1,jc_central_atom:null,jc_radius:1.5,jc_sphere_show:!0,jc_homonuclear:!1,jc_precision:2},Ve=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"hasData",get:function(){var e=this.state.app_viewer;return e&&e.model&&e.model.hasArray("isc")}},{key:"isOn",get:function(){return this.state.jc_links_on},set:function(e){var t={jc_links_on:e,listen_update:[ue.JC_LINKS]};e||(t.jc_central_atom=null),this.dispatch({type:"update",data:t})}},{key:"centralAtom",get:function(){return this.state.jc_central_atom}},{key:"radius",get:function(){return this.state.jc_radius},set:function(e){this.dispatch({type:"update",data:{jc_radius:e}})}},{key:"homonuclearOnly",get:function(){return this.state.jc_homonuclear},set:function(e){this.dispatch({type:"update",data:{jc_homonuclear:e,listen_update:[ue.JC_LINKS]}})}},{key:"showSphere",get:function(){return this.state.jc_sphere_show},set:function(e){this.dispatch({type:"update",data:{jc_sphere_show:e,listen_update:[ue.JC_RENDER]}})}},{key:"precision",get:function(){return this.state.jc_precision},set:function(e){this.dispatch({type:"update",data:{jc_precision:e,listen_update:[ue.JC_LINKS]}})}},{key:"reset",value:function(){this.isOn=Ge.jc_links_on,this.showSphere=Ge.jc_sphere_show,this.precision=Ge.jc_precision,this.homonuclearOnly=Ge.jc_homonuclear,this.radius=Ge.jc_radius}},{key:"bind",value:function(){var e=this._dispatcher,t=this.state.app_click_handler;t&&t.setCallback("jc",Be,(function(t,n){t.opacity<1||e({type:"update",data:{jc_central_atom:t,listen_update:[ue.JC_LINKS]}})}))}},{key:"unbind",value:function(){var e=this.state.app_click_handler;e&&e.setCallback("jc",Be)}}]),n}(J);var Je=function(){var e=Object(T.d)(P("jc",["app_click_handler","app_viewer"]),T.b),t=Object(T.c)();return new Ve(e,t)},Ke=fe.a.LEFT_CLICK,qe=fe.a.RIGHT_CLICK,We={eul_atom_A:null,eul_newatom_A:null,eul_tensor_A:"ms",eul_atom_B:null,eul_newatom_B:null,eul_tensor_B:"ms",eul_convention:"zyz",eul_results:null},He=new Set(["ms","efg"]),Ze=new Set(["zyz","zxz"]);function Ue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"A";function n(n,a){var s;e({type:"update",data:(s={},Object(A.a)(s,"eul_newatom_"+t,n),Object(A.a)(s,"listen_update",[ue.EUL_ANGLES]),s)})}return n}function Qe(e){return{type:"update",data:Object(M.a)(Object(M.a)({},e),{},{listen_update:[ue.EUL_ANGLES]})}}var Ye=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"hasModel",get:function(){return this.state.app_viewer&&this.state.app_viewer.model}},{key:"hasMSData",get:function(){var e=this.state.app_viewer;return e&&e.model&&e.model.hasArray("ms")}},{key:"hasEFGData",get:function(){var e=this.state.app_viewer;return e&&e.model&&e.model.hasArray("efg")}},{key:"convention",get:function(){return this.state.eul_convention},set:function(e){if(!Ze.has(e))throw Error("Invalid Euler angles convention");this.dispatch(Qe({eul_convention:e}))}},{key:"_getAtomLabel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"A",t=this.state["eul_atom_"+e];return t?t.crystLabel:"Not selected"}},{key:"_setTensorType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"A";if(!He.has(e))throw Error("Invalid NMR tensor for Euler angles");this.dispatch(Qe(Object(A.a)({},"eul_tensor_"+t,e)))}},{key:"atomA",get:function(){return this.state.eul_atom_A}},{key:"atomLabelA",get:function(){return this._getAtomLabel("A")}},{key:"atomB",get:function(){return this.state.eul_atom_B}},{key:"atomLabelB",get:function(){return this._getAtomLabel("B")}},{key:"tensorA",get:function(){return this.state.eul_tensor_A},set:function(e){this._setTensorType(e,"A")}},{key:"tensorB",get:function(){return this.state.eul_tensor_B},set:function(e){this._setTensorType(e,"B")}},{key:"_getResult",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?1:180/Math.PI,a=this.state.eul_results;return a?a[e]*n:"N/A"}},{key:"alpha",get:function(){return this._getResult(0)}},{key:"beta",get:function(){return this._getResult(1)}},{key:"gamma",get:function(){return this._getResult(2)}},{key:"alphaRad",get:function(){return this._getResult(0,!0)}},{key:"betaRad",get:function(){return this._getResult(1,!0)}},{key:"gammaRad",get:function(){return this._getResult(2,!0)}},{key:"bind",value:function(){var e=this._dispatcher,t=this.state.app_click_handler;t&&(t.setCallback("eul",Ke,Ue(e,"A")),t.setCallback("eul",qe,Ue(e,"B")))}},{key:"unbind",value:function(){var e=this.state.app_click_handler;e&&(e.setCallback("eul",Ke),e.setCallback("eul",qe),this.dispatch(Qe({eul_newatom_A:null,eul_newatom_B:null})))}},{key:"txtReport",value:function(){var e="Euler angles between tensors:\n";return e+="".concat(this.tensorA," on ").concat(this.atomLabelA,"\nand\n"),e+="".concat(this.tensorB," on ").concat(this.atomLabelB,"\n\n"),e+="Convention: ".concat(this.convention.toUpperCase(),"\n\n"),e+="Degrees:\n".concat(this.alpha,"    ").concat(this.beta,"    ").concat(this.gamma,"\n\n"),e+="Radiants:\n".concat(this.alphaRad,"     ").concat(this.betaRad,"     ").concat(this.gammaRad)}},{key:"txtSelfAngleTable",value:function(){if(!this.hasMSData||!this.hasEFGData)throw Error("Both MS and EFG tensors are needed to compute the table");var e=this.state.app_viewer.selected,t=(e=e.length>0?e:this.state.app_viewer.displayed).map((function(e,t){return[e.crystLabel,e.getArrayValue("ms"),e.getArrayValue("efg")]})),n="Euler angles between MS and EFG tensors in radiants, convention: ".concat(this.convention.toUpperCase(),"\n"),a=this.convention;return t.forEach((function(e,t){var s=Object(l.a)(e,3),i=s[0],c=L(s[1],s[2],a),r=Object(l.a)(c,3),o=r[0],d=r[1],u=r[2];n+="".concat(i,"    ").concat(o,"    ").concat(d,"    ").concat(u,"\n")})),n}}]),n}(K);var Xe=function(){var e=Object(T.d)(P("eul",["app_viewer","app_click_handler"]),T.b),t=Object(T.c)();return new Ye(e,t)};function $e(e,t){var n={};return e.app_viewer.model&&(n=Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)({},ve),ge),Ee),Ae),Te),Ge),We)),Object(M.a)(Object(M.a)({},n),{},{app_model_queued:t,listen_update:[ue.SEL_LABELS,ue.CSCALE,ue.MS_ELLIPSOIDS,ue.MS_LABELS,ue.EFG_ELLIPSOIDS,ue.EFG_LABELS,ue.DIP_LINKS,ue.JC_LINKS]})}function et(e){var t;return t=Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)({},ve),ge),Ee),Ae),Te),Ge),We),Object(M.a)(Object(M.a)({},t),{},{app_model_queued:e,listen_update:[ue.SEL_LABELS,ue.CSCALE,ue.MS_ELLIPSOIDS,ue.MS_LABELS,ue.EFG_ELLIPSOIDS,ue.EFG_LABELS,ue.DIP_LINKS,ue.JC_LINKS]})}function tt(e,t){var n=e.app_viewer,a={};n.deleteModel(t);var s=n.modelList;return!n.model&&s.length>0&&(a=$e(e,s[0])),a}var nt=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"initialised",get:function(){return null!==this.viewer}},{key:"viewer",get:function(){return this.state.app_viewer}},{key:"models",get:function(){var e=[];return this.initialised&&(e=this.viewer.modelList),e}},{key:"currentModel",get:function(){var e=null;return this.initialised&&(e=this.viewer.model),e}},{key:"currentModelName",get:function(){var e=null;return this.initialised&&(e=this.viewer.modelName),e}},{key:"theme",get:function(){return this.state.app_theme},set:function(e){this.dispatch({type:"set",key:"app_theme",value:e})}},{key:"sidebar",get:function(){return this.state.app_sidebar},set:function(e){this.dispatch({type:"set",key:"app_sidebar",value:e})}},{key:"loadAsMol",get:function(){return this.state.app_load_as_mol},set:function(e){this.dispatch({type:"set",key:"app_load_as_mol",value:e})}},{key:"useNMRIsotopes",get:function(){return this.state.app_use_nmr_isos},set:function(e){this.dispatch({type:"set",key:"app_use_nmr_isos",value:e})}},{key:"initialise",value:function(e){console.log("Initialising CrystVis app on element "+e);var t=new fe.a(e);t.highlightSelected=!0;var n=new N(t,[fe.a.LEFT_CLICK,fe.a.LEFT_CLICK+fe.a.SHIFT_BUTTON,fe.a.LEFT_CLICK+fe.a.CTRL_BUTTON,fe.a.RIGHT_CLICK]);this.initialised||this.dispatch({type:"update",data:{app_viewer:t,app_click_handler:n}})}},{key:"load",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.initialised){var n=new v(e.length,t),a=this.viewer,s=this,i={supercell:[3,3,3],molecularCrystal:this.loadAsMol,useNMRActiveIsotopes:this.useNMRIsotopes};o.a.forEach(e,l)}function c(e,c,l){var r=a.loadModels(e,l,c,i),d=null;o.a.map(r,(function(e,t){0===e&&(d=t)})),d&&s.display(d),t&&n.call(r)}function l(e){var t=new FileReader,n=e.name.split(".")[0],a=e.name.split(".").pop();t.onload=function(e){c(e.target.result,n,a)},t.readAsText(e)}}},{key:"display",value:function(e){this.dispatch({type:"call",function:$e,arguments:[e]})}},{key:"reload",value:function(e){this.dispatch({type:"call",function:et,arguments:[e]})}},{key:"delete",value:function(e){this.dispatch({type:"call",function:tt,arguments:[e]})}}]),n}(J);var at=function(){var e=Object(T.d)(P("app"),T.b),t=Object(T.c)();return new nt(e,t)};function st(e){return{type:"update",data:Object(M.a)(Object(M.a)({},e),{},{listen_update:[ue.PLOTS_RECALC]})}}var it=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"mode",get:function(){return this.state.plots_mode},set:function(e){this.dispatch(st({plots_mode:e}))}},{key:"useQ2Shift",get:function(){return this.state.plots_q2_shifts},set:function(e){this.dispatch(st({plots_q2_shifts:e}))}},{key:"useRefTable",get:function(){return this.state.plots_use_refs},set:function(e){this.dispatch(st({plots_use_refs:e}))}},{key:"showAxes",get:function(){return this.state.plots_show_axes},set:function(e){this.dispatch({type:"update",data:{plots_show_axes:e}})}},{key:"showGrid",get:function(){return this.state.plots_show_grid},set:function(e){this.dispatch({type:"update",data:{plots_show_grid:e}})}},{key:"showLabels",get:function(){return this.state.plots_show_labels},set:function(e){this.dispatch({type:"update",data:{plots_show_labels:e}})}},{key:"peakW",get:function(){return this.state.plots_peak_width},set:function(e){this.dispatch(st({plots_peak_width:e}))}},{key:"rangeX",get:function(){return[this.state.plots_min_x,this.state.plots_max_x]}},{key:"floatRangeX",get:function(){var e=parseFloat(this.state.plots_min_x),t=parseFloat(this.state.plots_max_x);return[e=isNaN(e)?0:e,t=isNaN(t)?e+100:t]}},{key:"rangeY",get:function(){return[this.state.plots_min_y,this.state.plots_max_y]}},{key:"floatRangeY",get:function(){var e=parseFloat(this.state.plots_min_y),t=parseFloat(this.state.plots_max_y);return[e=isNaN(e)?0:e,t=isNaN(t)?e+100:t]}},{key:"xSteps",get:function(){return this.state.plots_x_steps},set:function(e){this.dispatch(st({plots_x_steps:e}))}},{key:"setRange",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";"xy".indexOf(a)<0||(t=null===t?this.state["plots_min_"+a]:t,n=null===n?this.state["plots_max_"+a]:n,this.dispatch({type:"update",data:(e={},Object(A.a)(e,"plots_min_"+a,t),Object(A.a)(e,"plots_max_"+a,n),Object(A.a)(e,"listen_update",[ue.PLOTS_RECALC]),e)}))}},{key:"data",get:function(){return this.state.plots_data}},{key:"downloadSVG",value:function(){var e=document.querySelector("#root > div > div > div.mv-control.mv-modal.mv-modal-draggable.mv-modal-resizable > div.mv-modal-content > div > div > svg"),t=(new XMLSerializer).serializeToString(e),n=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),a=URL.createObjectURL(n),s=document.createElement("a");s.href=a,s.download="plot.svg",document.body.appendChild(s),s.click(),document.body.removeChild(s)}},{key:"downloadData",value:function(){var e=this.data[0].data,t="data:text/csv;charset=utf-8,",n=this.useRefTable?"Chemical shift /ppm":"Shielding /ppm",a=this.useRefTable?-1:1;t+=n+", Intensity \n",e.forEach((function(e){var n=a*e.x+", "+e.y+"\n";t+=n}));var s=encodeURI(t),i=document.createElement("a");i.setAttribute("href",s),i.setAttribute("download","magresview_plot_data.csv"),document.body.appendChild(i),i.click(),document.body.removeChild(i)}},{key:"bkgImage",get:function(){return this.state.plots_bkg_img_url?{url:this.state.plots_bkg_img_url,width:this.state.plots_bkg_img_w,height:this.state.plots_bkg_img_h}:null}},{key:"loadBkgImage",value:function(e){var t=this._dispatcher;(function(e){var t=new FileReader;return new Promise((function(n,a){t.onload=function(e){var t=new Image;t.src=e.target.result,t.decode().then((function(){n(t)}))},t.readAsDataURL(e)}))})(e[0]).then((function(e){t({type:"update",data:{plots_bkg_img_url:e.src,plots_bkg_img_w:e.naturalWidth,plots_bkg_img_h:e.naturalHeight}})}))}},{key:"clearBkgImage",value:function(){this.dispatch({type:"update",data:{plots_bkg_img_url:null,plots_bkg_img_w:0,plots_bkg_img_h:0}})}}]),n}(K);var ct=function(){var e=Object(T.d)(P("plots",["app_viewer"]),T.b),t=Object(T.c)();return new it(e,t)},lt=function(e){Object(D.a)(n,e);var t=Object(F.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"fileType",get:function(){return this.state.files_seltype},set:function(e){this.dispatch({type:"set",key:"files_seltype",value:e})}},{key:"fileName",get:function(){var e=this.state.app_viewer.modelName,t=this.state.files_seltype;return e?"mvtable_".concat(e,"_").concat(t,".txt"):"N/A"}},{key:"fileValid",get:function(){var e=this.state.app_viewer;if(!e||!e.model)return!1;switch(this.state.files_seltype){case"ms":return this.hasMSData;case"efg":return this.hasEFGData;case"isc":return this.hasISCData;case"spinsys":return this.hasMSData&&this.spinSysIncludeMS||this.hasEFGData&&this.spinSysIncludeEFG||this.spinSysIncludeD||this.hasISCData&&this.spinSysIncludeJ}return!0}},{key:"hasMSData",get:function(){var e=this.state.app_viewer;return e&&e.model&&e.model.hasArray("ms")}},{key:"hasEFGData",get:function(){var e=this.state.app_viewer;return e&&e.model&&e.model.hasArray("efg")}},{key:"hasISCData",get:function(){var e=this.state.app_viewer;return e&&e.model&&e.model.hasArray("isc")}},{key:"spinSysIncludeD",get:function(){return this.state.files_includeD},set:function(e){this.dispatch({type:"update",data:{files_includeD:e}})}},{key:"spinSysIncludeJ",get:function(){return this.state.files_includeJ},set:function(e){this.dispatch({type:"update",data:{files_includeJ:e}})}},{key:"spinSysIncludeEFG",get:function(){return this.state.files_includeEFG},set:function(e){this.dispatch({type:"update",data:{files_includeEFG:e}})}},{key:"spinSysIncludeMS",get:function(){return this.state.files_includeMS},set:function(e){this.dispatch({type:"update",data:{files_includeMS:e}})}},{key:"spinSysQuadrupoleOrder",get:function(){return this.state.files_quadrupole_order},set:function(e){this.dispatch({type:"update",data:{files_quadrupole_order:e}})}},{key:"spinSysOptions",get:function(){return{includeD:this.state.files_includeD,includeJ:this.state.files_includeJ,includeEFG:this.state.files_includeEFG,includeMS:this.state.files_includeMS,quadrupoleOrder:this.spinSysQuadrupoleOrder}}},{key:"generateFile",value:function(){var e="",t=this.state.app_viewer,n=null;if(t&&t.model&&(n=B(t)),!n)return null;switch(this.state.files_seltype){case"ms":e=this._msMakeTable(n);break;case"efg":e=this._efgMakeTable(n);break;case"dip":e=this._dipMakeTable(n);break;case"isc":e=this._iscMakeTable(n);break;case"spinsys":e=this._spinsysMakeTable(n,this.spinSysOptions);break;default:return null}return e}},{key:"_msMakeTable",value:function(e){var t=this.state.eul_convention,n="MS Table generated by MagresView 2\n";n+="Euler angles convention: ".concat(t,"\n\n"),n+=O(["Label","Element","Index","s_iso/ppm","Anisotropy/ppm","Asymmetry","alpha","beta","gamma"],20);var a=G(e,"iso","ms")[1],s=G(e,"aniso","ms")[1],i=G(e,"asymm","ms")[1],c=e.atoms.map((function(e){return C(e.getArrayValue("ms").haeberlen_eigenvectors,t).map((function(e){return 180*e/Math.PI}))}));return e.atoms.forEach((function(e,t){n+=O([e.crystLabel,e.isotope+e.element,e.index+1,a[t],s[t],i[t],c[t][0],c[t][1],c[t][2]],20,5)})),n}},{key:"_efgMakeTable",value:function(e){var t=this.state.eul_convention,n="EFG Table generated by MagresView 2\n";n+="Euler angles convention: ".concat(t,"\n\n"),n+=O(["Label","Element","Index","Vzz/au","Anisotropy/au","Asymmetry","Q/MHz","alpha","beta","gamma"],20);var a=G(e,"e_z","efg")[1],s=G(e,"aniso","efg")[1],i=G(e,"asymm","efg")[1],c=G(e,"Q","efg")[1]/1e6,l=e.atoms.map((function(e){return C(e.getArrayValue("efg").haeberlen_eigenvectors,t).map((function(e){return 180*e/Math.PI}))}));return e.atoms.forEach((function(e,t){n+=O([e.crystLabel,e.isotope+e.element,e.index+1,a[t],s[t],i[t],c[t],l[t][0],l[t][1],l[t][2]],20,5)})),n}},{key:"_dipMakeTable",value:function(e){var t="Dipolar coupling table generated by MagresView 2\n\n";t+=O(["Label 1","Element 1","Index 1","Label 2","Element 2","Index 2","D/kHz","r_x/Ang","r_y/Ang","r_z/Ang"],20);var n=e.atoms;return n.forEach((function(e,a){n.slice(a+1).forEach((function(n,a){var s=k(e,n),i=Object(l.a)(s,2),c=i[0],r=i[1];t+=O([e.crystLabel,e.isotope+e.element,e.index+1,n.crystLabel,n.isotope+n.element,n.index+1,c,r[0],r[1],r[2]],20,5)}))})),t}},{key:"_iscMakeTable",value:function(e){var t="J coupling table generated by MagresView 2\n\n";t+=O(["Label 1","Element 1","Index 1","Label 2","Element 2","Index 2","J/Hz"],20);var n=e.atoms;return n.forEach((function(e,a){n.slice(a+1).forEach((function(n,a){var s=w(e,n);s&&(t+=O([e.crystLabel,e.isotope+e.element,e.index+1,n.crystLabel,n.isotope+n.element,n.index+1,s],20,5))}))})),t}},{key:"_spinsysMakeTable",value:function(e,t){var n=this.state.eul_convention,a="{spinsys\n";a+="channels ";var s=e.atoms.map((function(e){return e.isotope+e.element})),i=new Set(s);if(a+=Array.from(i).join("    "),a+="\n",a+="    nuclei ",a+=s.join("    "),a+="\n",t.includeMS)if(this.hasMSData){var c=G(e,"iso","ms")[1],r=G(e,"reduced_aniso","ms")[1],o=G(e,"asymm","ms")[1],d=e.atoms.map((function(e){return C(e.getArrayValue("ms").haeberlen_eigenvectors,n).map((function(e){return 180*e/Math.PI}))}));e.atoms.forEach((function(e,t){a+=O(["shift",t+1,-c[t].toFixed(5).toString()+"p",-r[t].toFixed(5).toString()+"p",o[t],d[t][0],d[t][1],d[t][2]],20,5)}))}else console.warn("No MS data found. Skipping MS data in spinsys table.");if(t.includeEFG)if(this.hasEFGData){var u=t.quadrupoleOrder;if(u>0){u>2&&console.warn("Warning: quadrupole order > 2 not supported");var h=G(e,"Q","efg")[1],p=G(e,"asymm","efg")[1],f=e.atoms.map((function(e){return C(e.getArrayValue("efg").haeberlen_eigenvectors,n).map((function(e){return 180*e/Math.PI}))}));e.atoms.forEach((function(e,t){var n=h[t];n&&0!==n&&(a+=O(["quadrupole",t+1,u,1e6*n,p[t],f[t][0],f[t][1],f[t][2]],20,5))}))}}else console.warn("No EFG data found. Skipping EFG data in spinsys table.");if(t.includeD){var b=e.atoms;b.forEach((function(e,t){b.slice(t+1).forEach((function(n,s){var i=k(e,n),c=Object(l.a)(i,2),r=c[0],o=c[1],d=Math.atan2(-o[1],-o[0])%(2*Math.PI),u=Math.acos(-o[2])%(2*Math.PI),h=180*d/Math.PI,p=180*u/Math.PI;a+=O(["dipole",s+1,t+1,r,h,p,0],20,5)}))}))}return a+="}"}}]),n}(J);var rt=function(){var e=Object(T.d)(P("files",["app_viewer","app_default_displayed","eul_convention"]),T.b),t=Object(T.c)();return new lt(e,t)},ot=Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)(Object(M.a)({},{app_viewer:null,app_click_handler:null,app_theme:"dark",app_sidebar:"load",app_default_displayed:null,app_model_queued:null,app_load_as_mol:null,app_use_nmr_isos:!0}),ve),ge),Ee),Ae),Te),Ge),We),{files_seltype:"ms",files_includeJ:!1,files_includeD:!1,files_includeEFG:!0,files_includeMS:!0,files_quadrupole_order:2}),{plots_mode:"none",plots_use_refs:!1,plots_q2_shifts:!0,plots_show_axes:!0,plots_show_grid:!0,plots_bkg_img_url:null,plots_bkg_img_w:0,plots_bkg_img_h:0,plots_min_x:0,plots_max_x:100,plots_min_y:0,plots_max_y:5,plots_peak_width:2,plots_x_steps:100,plots_data:null,plots_show_labels:!0}),{listen_update:[]});var dt=Object(R.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{type:"none"};switch(t.type){case"set":e=Object(M.a)(Object(M.a)({},e),{},Object(A.a)({},t.key,t.value));break;case"update":e=Object(M.a)(Object(M.a)({},e),t.data);break;case"call":var n=[e].concat(t.arguments),a=t.function.apply(t,Object(I.a)(n));e=Object(M.a)(Object(M.a)({},e),a)}return e}));dt.subscribe(pe(dt));var ut=dt,ht=(n(254),n.p+"static/media/logo.09fd6d2f.svg"),pt=n(35),ft=n(92),bt=(n(255),n(1));function jt(e){var t=e.onClick||function(){};return Object(bt.jsxs)("div",{className:"mv-control mv-cselect-opt",onClick:t,children:[e.icon?e.icon:Object(bt.jsx)("span",{}),e.children]})}var mt=function(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),s=n[0],i=n[1],c=e.children.filter((function(e){return e.type===jt})),r=c.map((function(e){return e.props.value})),o=r.findIndex((function(t){return t===e.selected})),u=e.onSelect||function(){};return Object(a.useEffect)((function(){e.disabled&&i(!1)}),[e.disabled]),Object(bt.jsxs)("div",{style:{},className:d("mv-control","mv-cselect",s?null:"mv-cselect-closed",e.disabled?"mv-cselect-disabled":null),onMouseLeave:function(e){i(!1)},title:e.title,children:[Object(bt.jsxs)("div",{className:"mv-control mv-cselect-main",onClick:function(){i(!e.disabled)},children:[c[o],Object(bt.jsx)("span",{className:"mv-cselect-main-caret",children:Object(bt.jsx)(pt.d,{})})]}),Object(bt.jsx)("div",{className:"mv-control mv-cselect-ddown",children:c.map((function(e,t){return Object(a.cloneElement)(e,{key:t,onClick:function(){i(!1),u(r[t])}})}))})]})},vt=(n(257),["title","titleId"]);function _t(){return _t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_t.apply(this,arguments)}function Ot(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function gt(e,t){var n=e.title,s=e.titleId,i=Ot(e,vt);return a.createElement("svg",_t({width:"4.2333336mm",height:"4.2333336mm",viewBox:"0 0 4.2333336 4.2333336",id:"svg47",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":s},i),n?a.createElement("title",{id:s},n):null,a.createElement("g",{transform:"translate(-18.293285,-29.905846)"},a.createElement("path",{id:"path31-3",style:{fill:"#ffffff",strokeWidth:.113242,strokeLinecap:"round",strokeLinejoin:"round",paintOrder:"fill markers stroke"},d:"m 20.409953,29.969924 a 2.0525921,2.0525921 0 0 0 -2.052588,2.052588 2.0525921,2.0525921 0 0 0 2.052588,2.052588 2.0525921,2.0525921 0 0 0 2.052588,-2.052588 2.0525921,2.0525921 0 0 0 -2.052588,-2.052588 z m 0,0.304891 a 1.7477165,1.7477165 0 0 1 1.747697,1.747697 1.7477165,1.7477165 0 0 1 -1.747697,1.747697 1.7477165,1.7477165 0 0 1 -1.747697,-1.747697 1.7477165,1.7477165 0 0 1 1.747697,-1.747697 z m 0,0.981852 a 0.76590603,0.76590603 0 0 0 -0.765845,0.765845 0.76590603,0.76590603 0 0 0 0.765845,0.765844 0.76590603,0.76590603 0 0 0 0.765844,-0.765844 0.76590603,0.76590603 0 0 0 -0.765844,-0.765845 z"})))}var yt,xt=a.forwardRef(gt),kt=(n.p,["title","titleId"]);function wt(){return wt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},wt.apply(this,arguments)}function St(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function Et(e,t){var n=e.title,s=e.titleId,i=St(e,kt);return a.createElement("svg",wt({width:"4.2333336mm",height:"4.2333336mm",viewBox:"0 0 4.2333336 4.2333336",id:"svg967",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":s},i),n?a.createElement("title",{id:s},n):null,yt||(yt=a.createElement("defs",{id:"defs11"})),a.createElement("g",{id:"path4379",style:{fill:"#ffffff",fillOpacity:1}},a.createElement("path",{style:{color:"#000000",fill:"#ffffff",strokeWidth:.242209,InkscapeStroke:"none",fillOpacity:1},d:"M 2.5730992,0.53564415 C 2.0763787,1.0247144 2.1174995,2.1158593 2.1174995,2.1158593 c 0,0 1.090811,0.040787 1.5798807,-0.4559341 C 4.1697678,1.1801491 3.9991355,0.77827206 3.7271516,0.50620724 3.4550908,0.23406562 3.0528756,0.06325682 2.5730992,0.53564415 Z",id:"path949"}),a.createElement("path",{style:{color:"#000000",fill:"#ffffff",InkscapeStroke:"none",fillOpacity:1},d:"m 3.2382813,0.12109375 c -0.2336518,-0.021225 -0.4928561,0.0749413 -0.75,0.328125 C 2.2066461,0.72651627 2.0927766,1.1440416 2.0390625,1.4902344 1.9853484,1.8364272 1.9960938,2.1210938 1.9960937,2.1210938 L 2,2.2324219 l 0.1132813,0.00391 c 0,0 0.2827996,0.010832 0.6289062,-0.042969 C 3.0882941,2.1395587 3.5059251,2.0257566 3.7832031,1.7441406 4.0363717,1.4870123 4.1324787,1.2277171 4.1113281,0.99414063 4.0901775,0.7605642 3.9606182,0.56808419 3.8125,0.41992188 3.6643293,0.27170718 3.471933,0.14231875 3.2382813,0.12109375 Z m -0.021484,0.2421875 C 3.3722117,0.37739918 3.5167352,0.46787023 3.640625,0.59179687 3.7644904,0.71569911 3.8570292,0.86030307 3.8710938,1.015625 3.8851583,1.1709469 3.8305467,1.3515714 3.6113281,1.5742187 3.399537,1.7893233 3.0266438,1.9050922 2.7050781,1.9550781 c -0.251685,0.039123 -0.3754283,0.03197 -0.4570312,0.03125 -7.728e-4,-0.080876 -0.00797,-0.2062232 0.03125,-0.4589844 0.049905,-0.3216465 0.1638213,-0.69447771 0.3789062,-0.90624995 0.222632,-0.21920321 0.403179,-0.27193043 0.5585938,-0.2578125 z",id:"path951"})),a.createElement("g",{id:"path4379-8"},a.createElement("path",{style:{color:"#000000",fill:"#ffffff",strokeWidth:.242209,InkscapeStroke:"none"},d:"M 1.6602402,3.6976978 C 2.1569607,3.2086275 2.11584,2.1174825 2.11584,2.1174825 c 0,0 -1.0908111,-0.040787 -1.57988078,0.4559342 -0.4723876,0.4797762 -0.3017553,0.8816532 -0.0297709,1.153718 C 0.7782491,3.9992763 1.1804642,4.1700851 1.6602402,3.6976978 Z",id:"path957"}),a.createElement("path",{style:{color:"#000000",fill:"#fefefe",InkscapeStroke:"none"},d:"m 2.1210938,1.9960937 c 0,0 -0.2847528,-0.010832 -0.6308594,0.042969 -0.3461066,0.053801 -0.76373761,0.1676027 -1.04101565,0.4492188 -0.25316852,0.2571283 -0.34927569,0.5164235 -0.328125,0.75 C 0.14224444,3.4718577 0.27180335,3.6643377 0.41992188,3.8125 0.56809254,3.9607147 0.76048898,4.0901031 0.99414063,4.1113281 1.2277923,4.1325531 1.48895,4.0363868 1.7460937,3.7832031 2.0277289,3.5059056 2.1396453,3.0883803 2.1933594,2.7421875 2.2470735,2.3959947 2.2363281,2.1132813 2.2363281,2.1132813 L 2.2324219,2 Z M 1.9863281,2.2480469 c 7.439e-4,0.081628 0.00781,0.2052829 -0.03125,0.4570312 C 1.9051725,3.0267247 1.7912568,3.3995559 1.5761719,3.6113281 1.3535401,3.8305313 1.1710397,3.8852117 1.015625,3.8710938 0.86021029,3.8569758 0.71568671,3.7645516 0.59179687,3.640625 0.46793127,3.5167228 0.37734588,3.3721188 0.36328125,3.2167969 0.34921662,3.061475 0.40382827,2.8808505 0.62304687,2.6582031 0.83483802,2.4430985 1.2057781,2.3292828 1.5273437,2.2792969 1.7800414,2.2400162 1.905477,2.2472982 1.9863281,2.2480469 Z",id:"path959"})),a.createElement("path",{style:{color:"#000000",fill:"#fefefe",InkscapeStroke:"none"},d:"M 2.1132813,1.9960937 2,2 1.9960937,2.1132813 c 0,0 -0.010745,0.2827134 0.042969,0.6289062 0.053714,0.3461928 0.1675836,0.7637181 0.4492188,1.0410156 0.2571437,0.2531837 0.5163483,0.34935 0.75,0.328125 C 3.4719329,4.0901031 3.6643293,3.9607147 3.8125,3.8125 3.9606185,3.6643377 4.0901775,3.4718577 4.1113281,3.2382813 4.1324788,3.0047048 4.0363716,2.7454096 3.7832031,2.4882813 3.5059251,2.2066652 3.0882941,2.0928632 2.7421875,2.0390625 2.3960809,1.9852618 2.1132812,1.9960937 2.1132813,1.9960937 Z m 0.1347656,0.2519532 c 0.081645,-7.179e-4 0.2054038,-0.00786 0.4570312,0.03125 0.3215657,0.049986 0.6944589,0.1638016 0.90625,0.3789062 C 3.8305467,2.8808505 3.8851584,3.061475 3.8710938,3.2167969 3.8570291,3.3721188 3.7644906,3.5167228 3.640625,3.640625 3.5167352,3.7645516 3.3722116,3.8569758 3.2167969,3.8710938 3.0613821,3.8852117 2.8808349,3.8305313 2.6582031,3.6113281 2.4431182,3.3995559 2.3292024,3.0267247 2.2792969,2.7050781 2.2402454,2.4533874 2.2473047,2.3297177 2.2480469,2.2480469 Z",id:"path4379-8-7"}),a.createElement("path",{style:{color:"#000000",fill:"#fefefe",InkscapeStroke:"none"},d:"M 0.99414063,0.12304687 C 0.76052273,0.14426881 0.56808207,0.27367078 0.41992188,0.421875 0.27181384,0.57002685 0.14224137,0.76255105 0.12109375,0.99609375 0.09994613,1.2296364 0.19606487,1.4889803 0.44921875,1.7460937 0.72646854,2.0276811 1.1441384,2.1415134 1.4902344,2.1953125 c 0.346096,0.053799 0.6308594,0.042969 0.6308594,0.042969 l 0.1113281,-0.00391 0.00391,-0.1132812 c 0,0 0.010744,-0.2827241 -0.042969,-0.6289063 C 2.1396469,1.1460053 2.0277002,0.72844112 1.7460937,0.45117188 1.4889649,0.19800288 1.2277585,0.10182494 0.99414063,0.12304687 Z M 1.015625,0.36328125 c 0.1554485,-0.014121 0.3379002,0.0405478 0.5605469,0.25976562 0.2151136,0.21180052 0.328999,0.58459283 0.3789062,0.90625003 0.039228,0.2528276 0.032025,0.3781486 0.03125,0.4589843 -0.08081,7.505e-4 -0.2062203,0.00804 -0.4589844,-0.03125 C 1.2057675,1.9070437 0.83486627,1.7913052 0.62304687,1.5761719 0.40381362,1.3535096 0.34921357,1.1729338 0.36328125,1.0175781 0.37734893,0.86222244 0.46792083,0.71766269 0.59179687,0.59375 0.71569719,0.46981287 0.86017652,0.37740225 1.015625,0.36328125 Z",id:"path4379-8-7-9"}))}var Ct,Lt=a.forwardRef(Et),Nt=(n.p,["title","titleId"]);function It(){return It=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},It.apply(this,arguments)}function At(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function Mt(e,t){var n=e.title,s=e.titleId,i=At(e,Nt);return a.createElement("svg",It({width:"4.2333336mm",height:"4.2333336mm",viewBox:"0 0 4.2333336 4.2333336",id:"svg967",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":s},i),n?a.createElement("title",{id:s},n):null,Ct||(Ct=a.createElement("defs",{id:"defs13"})),a.createElement("g",{id:"path1204"},a.createElement("path",{style:{color:"#000000",fill:"#fffffb",strokeWidth:.214,strokeLinecap:"round",strokeLinejoin:"round",InkscapeStroke:"none",paintOrder:"fill markers stroke"},d:"m 4.089079,2.0563225 c 0,1.0289629 -0.8331367,1.8631023 -1.3433946,1.8631023 -0.5102579,-10e-8 -0.5044128,-0.8341394 -0.5044128,-1.8631023 0,-1.0289628 -0.00584,-1.86310211 0.5044128,-1.86310221 0.5102579,0 1.3433946,0.83413931 1.3433946,1.86310221 z",id:"path1994"}),a.createElement("path",{style:{color:"#000000",fill:"#feffff",strokeLinecap:"round",strokeLinejoin:"round",InkscapeStroke:"none",paintOrder:"fill markers stroke"},d:"m 2.7460938,0.0859375 c -0.1567163,3e-8 -0.2914586,0.07367204 -0.3789063,0.18945313 C 2.2797398,0.39117171 2.2300544,0.54136545 2.1972656,0.71875 c -0.065577,0.3547691 -0.0625,0.8236122 -0.0625,1.3378906 0,0.5142784 -0.00308,0.9811683 0.0625,1.3359375 0.032788,0.1773846 0.082474,0.3295313 0.1699219,0.4453125 0.087448,0.1157812 0.2221891,0.1894531 0.3789063,0.1894531 0.3134343,0 0.6597622,-0.2320725 0.9453125,-0.5859374 0.2855502,-0.353865 0.5039062,-0.841406 0.5039062,-1.3847657 0,-0.5433597 -0.218356,-1.0309007 -0.5039062,-1.3847656 C 3.405856,0.31801006 3.0595281,0.0859375 2.7460938,0.0859375 Z m 0,0.21484375 c 0.196823,0 0.5207148,0.18541461 0.7792968,0.50585938 0.258582,0.32044477 0.4570313,0.76439787 0.4570313,1.24999997 0,0.4856022 -0.1984493,0.9295552 -0.4570313,1.25 C 3.2668086,3.6270854 2.9429167,3.8125 2.7460938,3.8125 2.6476822,3.8125 2.5920753,3.7817592 2.5371094,3.7089844 2.4821435,3.6362095 2.4377356,3.5132859 2.4082031,3.3535156 2.3491381,3.0339751 2.3476563,2.5713242 2.3476563,2.0566406 c 0,-0.5146833 0.00148,-0.9792875 0.060547,-1.2988281 0.029533,-0.1597703 0.07394,-0.28074067 0.1289063,-0.35351562 0.054966,-0.072775 0.1105744,-0.10351561 0.2089844,-0.10351563 z",id:"path1996"})),a.createElement("path",{style:{color:"#000000",fill:"#feffff",strokeLinecap:"round",strokeLinejoin:"round",InkscapeStroke:"none",paintOrder:"fill markers stroke"},d:"m 1.4882812,0.09765625 c -0.3134344,0 -0.66171528,0.23207255 -0.94726558,0.5859375 C 0.25546533,1.0374587 0.03710938,1.5249996 0.03710937,2.0683594 c 0,0.5433597 0.21835596,1.0309007 0.50390625,1.3847656 0.2855503,0.3538649 0.63383118,0.5839844 0.94726558,0.5839844 0.1567172,-1e-7 0.2914583,-0.071719 0.3789063,-0.1875 0.087448,-0.1157812 0.1371335,-0.2679279 0.1699219,-0.4453125 0.065577,-0.3547692 0.0625,-0.8216592 0.0625,-1.3359375 0,-0.5142785 0.00308,-0.9831215 -0.0625,-1.33789065 C 2.0043206,0.5530842 1.9546352,0.40289046 1.8671875,0.28710938 1.7797398,0.17132829 1.6449975,0.09765628 1.4882812,0.09765625 Z m 0,0.21484375 c 0.09841,2e-8 0.1540186,0.0307407 0.2089844,0.10351563 0.054966,0.0727749 0.099374,0.19374531 0.1289063,0.35351562 0.059066,0.31954065 0.058594,0.78414475 0.058594,1.29882815 0,0.5146835 4.713e-4,0.9773345 -0.058594,1.296875 -0.029532,0.1597702 -0.07394,0.2826939 -0.1289063,0.3554687 -0.054966,0.072775 -0.1105728,0.1035156 -0.2089844,0.1035157 -0.196823,0 -0.52266797,-0.1854147 -0.78124995,-0.5058594 -0.25858198,-0.3204448 -0.45507812,-0.7643979 -0.45507812,-1.25 0,-0.4856022 0.19649614,-0.9295553 0.45507812,-1.25000002 C 0.96561323,0.4979146 1.2914582,0.3125 1.4882812,0.3125 Z",id:"path1204-3"}))}var Rt,Dt=a.forwardRef(Mt),Ft=(n.p,["title","titleId"]);function Tt(){return Tt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Tt.apply(this,arguments)}function Pt(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function zt(e,t){var n=e.title,s=e.titleId,i=Pt(e,Ft);return a.createElement("svg",Tt({width:"4.2333336mm",height:"4.2333336mm",viewBox:"0 0 4.2333336 4.2333336",id:"svg967",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":s},i),n?a.createElement("title",{id:s},n):null,Rt||(Rt=a.createElement("defs",{id:"defs13"})),a.createElement("g",{id:"g2792",transform:"translate(-0.12942697,-0.24771585)"},a.createElement("path",{style:{color:"#000000",fill:"#fffffa",strokeLinecap:"round",strokeLinejoin:"round",InkscapeStroke:"none",paintOrder:"fill markers stroke"},d:"m 0.86132813,2.609375 a 0.25,0.25 0 0 0 -0.25000001,0.25 c 0,0.4485824 0.23846935,0.8635994 0.62695308,1.0878906 0.3884838,0.2242913 0.8693287,0.2242912 1.2578126,0 C 2.8845776,3.7229744 3.125,3.3079575 3.125,2.859375 a 0.25,0.25 0 0 0 -0.25,-0.25 0.25,0.25 0 0 0 -0.25,0.25 c 0,0.2707514 -0.1444286,0.5208743 -0.3789062,0.65625 -0.2344777,0.1353757 -0.523335,0.1353757 -0.7578126,0 C 1.2538037,3.3802493 1.1113281,3.1301264 1.1113281,2.859375 a 0.25,0.25 0 0 0 -0.24999997,-0.25 z",id:"path2096"}),a.createElement("path",{style:{color:"#000000",fill:"#fffffa",strokeLinecap:"round",InkscapeStroke:"none"},d:"m 2.875,0.61328125 a 0.25,0.25 0 0 0 -0.25,0.25 V 2.859375 a 0.25,0.25 0 0 0 0.25,0.25 0.25,0.25 0 0 0 0.25,-0.25 V 0.86328125 a 0.25,0.25 0 0 0 -0.25,-0.25 z",id:"path2453"}),a.createElement("path",{style:{color:"#000000",fill:"#fffffa",strokeLinecap:"round",InkscapeStroke:"none"},d:"m 2.1171875,0.61328125 a 0.25,0.25 0 0 0 -0.25,0.25 0.25,0.25 0 0 0 0.25,0.24999995 h 1.5136719 a 0.25,0.25 0 0 0 0.25,-0.24999995 0.25,0.25 0 0 0 -0.25,-0.25 z",id:"path2453-6"})))}var Bt,Gt=a.forwardRef(zt),Vt=(n.p,["title","titleId"]);function Jt(){return Jt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Jt.apply(this,arguments)}function Kt(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function qt(e,t){var n=e.title,s=e.titleId,i=Kt(e,Vt);return a.createElement("svg",Jt({width:"4.2333336mm",height:"4.2333336mm",viewBox:"0 0 4.2333336 4.2333336",id:"svg967",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":s},i),n?a.createElement("title",{id:s},n):null,Bt||(Bt=a.createElement("defs",{id:"defs11"})),a.createElement("g",{id:"g23220",transform:"translate(-0.12438843,0.37954715)"},a.createElement("path",{id:"rect3247",style:{fill:"#505050",strokeWidth:1.11706,strokeLinecap:"round",strokeLinejoin:"round",paintOrder:"fill markers stroke"},d:"M 0.70134777,2.576951 H 3.7807629 V 3.0747627 H 0.70134777 Z"}),a.createElement("path",{id:"rect3247-3",style:{fill:"#505050",strokeWidth:1.11706,strokeLinecap:"round",strokeLinejoin:"round",paintOrder:"fill markers stroke"},transform:"rotate(-45)",d:"M -1.5022547,2.2452056 H 1.5771604 V 2.7430173 H -1.5022547 Z"}),a.createElement("path",{id:"path7097",style:{fill:"#505050",strokeWidth:1.11706,strokeLinecap:"round",strokeLinejoin:"round",paintOrder:"fill markers stroke"},d:"M 0.95025361,2.8258569 A 0.24890584,0.24890584 0 0 1 0.70134777,3.0747628 0.24890584,0.24890584 0 0 1 0.45244193,2.8258569 0.24890584,0.24890584 0 0 1 0.70134777,2.5769511 0.24890584,0.24890584 0 0 1 0.95025361,2.8258569 Z"}),a.createElement("path",{id:"path7097-5",style:{fill:"#505050",strokeWidth:1.11706,strokeLinecap:"round",strokeLinejoin:"round",paintOrder:"fill markers stroke"},d:"M 3.1277298,0.64838237 A 0.24890584,0.24890584 0 0 1 2.878824,0.8972882 0.24890584,0.24890584 0 0 1 2.6299182,0.64838237 0.24890584,0.24890584 0 0 1 2.878824,0.39947653 0.24890584,0.24890584 0 0 1 3.1277298,0.64838237 Z"}),a.createElement("path",{id:"path7097-5-6",style:{fill:"#505050",strokeWidth:1.11706,strokeLinecap:"round",strokeLinejoin:"round",paintOrder:"fill markers stroke"},d:"M 4.0296685,2.8258569 A 0.24890584,0.24890584 0 0 1 3.7807627,3.0747628 0.24890584,0.24890584 0 0 1 3.5318568,2.8258569 0.24890584,0.24890584 0 0 1 3.7807627,2.5769511 0.24890584,0.24890584 0 0 1 4.0296685,2.8258569 Z"}),a.createElement("path",{id:"path7097-6",style:{fill:"#505050",fillOpacity:1,stroke:"none",strokeWidth:8.64555,strokeLinecap:"round",strokeLinejoin:"round",paintOrder:"fill markers stroke"},d:"M 2.0206488,1.4219955 1.735275,1.725696 A 1.5092943,1.5092943 0 0 1 2.2104616,2.811338 L 2.6276135,2.807408 A 1.9264272,1.9264272 0 0 0 2.0206488,1.4219955 Z"})))}var Wt=a.forwardRef(qt),Ht=(n.p,{ms:xt,efg:Lt,dip:Dt,jcoup:Gt,euler:Wt});var Zt=function(e){if(!(e.icon in Ht))throw new Error("Invalid icon in MVIcon");var t=Ht[e.icon],n=e.color||"#ffffff";return Object(bt.jsx)(t,Object(M.a)({className:"mv-icon",style:{"--path-fill":n}},e))};function Ut(){var e=at(),t={dark:"light",light:"dark"};return Object(bt.jsx)("div",{id:"mv-themeswitch",onClick:function(){e.theme=t[e.theme]},children:Object(bt.jsxs)("div",{id:"mv-themeicons",className:e.theme,children:[Object(bt.jsx)(pt.g,{id:"mv-themedark"}),Object(bt.jsx)(pt.j,{id:"mv-themelight"})]})})}var Qt=function(){var e=at();return Object(bt.jsxs)("header",{className:"mv-header",children:[Object(bt.jsxs)("div",{className:"mv-header-left",children:[Object(bt.jsx)("img",{src:ht,alt:"MagresView logo",id:"mv-header-logo"}),Object(bt.jsxs)("h3",{id:"mv-header-title",children:[Object(bt.jsx)("span",{style:{color:"var(--ms-color-2)"},children:"M"}),"agres",Object(bt.jsx)("span",{style:{color:"var(--efg-color-2)"},children:"V"}),"iew 2.0"]})]}),Object(bt.jsxs)("div",{className:"mv-header-right",children:[Object(bt.jsxs)(mt,{onSelect:function(t){e.sidebar=t},selected:e.sidebar,children:[Object(bt.jsx)(jt,{value:"load",icon:Object(bt.jsx)(pt.i,{}),children:"Load file"}),Object(bt.jsx)(jt,{value:"select",icon:Object(bt.jsx)(pt.h,{}),children:"Select and display"}),Object(bt.jsx)(jt,{value:"ms",icon:Object(bt.jsx)(Zt,{icon:"ms",color:"var(--ms-color-3)"}),children:"Magnetic Shielding"}),Object(bt.jsx)(jt,{value:"efg",icon:Object(bt.jsx)(Zt,{icon:"efg",color:"var(--efg-color-3)"}),children:"Electric Field Gradient"}),Object(bt.jsx)(jt,{value:"dip",icon:Object(bt.jsx)(Zt,{icon:"dip",color:"var(--dip-color-3)"}),children:"Dipolar Couplings"}),Object(bt.jsx)(jt,{value:"jcoup",icon:Object(bt.jsx)(Zt,{icon:"jcoup",color:"var(--jcoup-color-3)"}),children:"J Couplings"}),Object(bt.jsx)(jt,{value:"euler",icon:Object(bt.jsx)(Zt,{icon:"euler",color:"var(--bkg-color-3)"}),children:"Euler Angles"}),Object(bt.jsx)(jt,{value:"plots",icon:Object(bt.jsx)(ft.a,{}),children:"Spectral plots"}),Object(bt.jsx)(jt,{value:"files",icon:Object(bt.jsx)(pt.f,{}),children:"Report files"}),Object(bt.jsx)(jt,{value:"none",icon:Object(bt.jsx)(pt.b,{}),children:"No sidebar"})]}),Object(bt.jsx)("span",{className:"mv-hor-sep-3"}),Object(bt.jsx)(Ut,{})]})]})};n(258);var Yt=function(e){var t=at();return Object(bt.jsxs)("div",{className:"mv-sshot",onClick:function(){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image.png";g(e=e.replace("image/png","image/octet-stream"),t)}(t.viewer.getScreenshotData(),"MagresViewScreenshot.png")},children:[Object(bt.jsx)(pt.c,{}),Object(bt.jsx)("div",{className:"mv-sshot-text",children:"Take a screenshot"})]})};n(259);var Xt=function(e){var t=at();return Object(bt.jsxs)("div",{className:d("mv-sidebar",e.show?"open":""),children:[Object(bt.jsxs)("div",{className:"mv-sidebar-title",children:[e.title?Object(bt.jsx)("h2",{children:e.title}):null,Object(bt.jsx)(pt.a,{className:"mv-sidebar-hide",onClick:function(){t.sidebar="none"}})]}),e.children]})},$t=n(116),en=n(170),tn=n(171);n(260);var nn=function(e){return Object(bt.jsx)("input",{className:d("mv-control","mv-file",e.notext?"hide-text":null),type:"file",accept:e.filetypes,onChange:function(t){if(e.onSelect){var n=t.target.files;n.length>0&&e.onSelect(n)}t.target.value=null},multiple:e.multiple})},an=(n(261),n(167));var sn=function(e){var t=e.status?"mv-box-"+e.status:"",n=e.onClose||function(){};return Object(bt.jsxs)("div",{className:d("mv-control","mv-box",t),children:[Object(bt.jsx)("div",{className:"mv-box-header",children:Object(bt.jsx)(an.a,{onClick:n,size:22})}),e.children]})};n(262);var cn=function(e){var t=u("checkbox"),n={};e.color&&(n["--check-color"]=e.color);var a=e.onCheck||function(){};return Object(bt.jsxs)("span",{className:"mv-control mv-checkbox",style:n,title:e.title,children:[Object(bt.jsx)("input",{id:t,type:"checkbox",checked:e.checked,onChange:function(e){return a(e.target.checked)}}),Object(bt.jsx)("label",{htmlFor:t}),e.children]})};n(263);function ln(e){var t=e.onClick||function(){};return Object(bt.jsxs)("div",{className:d("mv-control","mv-lselect-opt",e.selected?"mv-lselected":null),onClick:t,children:[e.icon?e.icon:Object(bt.jsx)("span",{}),e.children]})}var rn=function(e){var t=e.children.filter((function(e){return e.type===ln})),n=t.map((function(e){return e.props.value})),s=n.findIndex((function(t){return t===e.selected})),i=e.onSelect||function(){};return Object(bt.jsx)("div",{className:"mv-control mv-lselect",title:e.title,children:t.map((function(e,t){return Object(a.cloneElement)(e,{key:t,selected:t===s,onClick:function(){i(n[t])}})}))})},on=n(179),dn=(n(264),n(169)),un=(n(265),function(e){var t=e.tooltipText,n=Object(a.useState)(!1),s=Object(l.a)(n,2),i=s[0],c=s[1],r=Object(on.a)({trigger:"hover",closeOnOutsideClick:!1,visible:i,onVisibleChange:c}),o=r.getArrowProps,d=r.getTooltipProps,u=r.setTooltipRef,h=r.setTriggerRef,p=r.visible;return Object(bt.jsxs)(bt.Fragment,{children:[Object(bt.jsx)("div",{className:"field-info",ref:h,children:Object(bt.jsx)(dn.a,{size:16,style:{color:"var(--ms-color-2)"}})}),p&&Object(bt.jsxs)("div",Object(M.a)(Object(M.a)({ref:u},d({className:"tooltip-container"})),{},{children:[t,Object(bt.jsx)("div",Object(M.a)({},o({className:"tooltip-arrow"})))]}))]})}),hn=Object(bt.jsxs)("div",{children:[Object(bt.jsxs)("p",{children:["MagresView tries to identify molecular units within the crystal structure. ",Object(bt.jsx)("br",{}),"It can then draw the correct periodic image of each atom such that full molecular units are visible. ",Object(bt.jsx)("br",{}),"This is especially useful for molecular crystals."]}),Object(bt.jsxs)("p",{children:[Object(bt.jsx)("b",{children:"Auto:"})," (default): it will do a very basic check to see if your structure looks organic (if it has C and H atoms). If it does, it will load it as a molecular crystal. ",Object(bt.jsx)("br",{}),Object(bt.jsx)("b",{children:"Yes:"})," it will load the structure as a molecular crystal. ",Object(bt.jsx)("br",{}),Object(bt.jsx)("b",{children:"No:"})," display structure exactly as in the loaded file."]})]}),pn=Object(bt.jsxs)("div",{children:[Object(bt.jsxs)("p",{children:[" MagresView will default to assuming NMR-active isotopes for each element, rather than the most abundant isotope. ",Object(bt.jsx)("br",{}),"You can disable this by unchecking this box. ",Object(bt.jsx)("br",{})]}),Object(bt.jsxs)("p",{children:["To set a custom isotope for each atom/element, use the ",Object(bt.jsx)("b",{children:"Select and display"})," tab."]})]}),fn=[".cif",".xyz",".magres",".cell"];var bn=function(e){var t=Object(a.useState)({load_message:"",load_message_status:null,list_selected:""}),n=Object(l.a)(t,2),s=n[0],i=n[1],c=at(),r=c.models;return console.log("[MVSidebarLoad rendered]"),Object(bt.jsxs)(Xt,{show:e.show,title:"Load file",children:[Object(bt.jsxs)("div",{className:"mv-sidebar-block",children:[Object(bt.jsx)(nn,{filetypes:fn.join(","),onSelect:function(e){c.load(e,(function(e){var t="",n=!1;o.a.map(e,(function(e,a){0!==e&&(t+="Error parsing file "+a+": "+e+"\n",n=!0)})),""===t&&(t="All files parsed successfully!"),i(Object(M.a)(Object(M.a)({},s),{},{load_message:t,load_message_status:n?"error":"success"}))}))},notext:!0,multiple:!0}),Object(bt.jsx)("span",{className:"sep-1"}),Object(bt.jsx)("div",{className:"mv-sidebar-block",children:Object(bt.jsxs)("div",{className:"mv-sidebar-tooltip-grid",children:[Object(bt.jsx)("div",{children:"Display unwrapped molecular units?\xa0"}),Object(bt.jsx)(un,{tooltipText:hn}),Object(bt.jsxs)(mt,{onSelect:function(e){c.loadAsMol=e},selected:c.loadAsMol,name:"loadasmol_dropdown",children:[Object(bt.jsx)(jt,{value:null,children:"Auto"}),Object(bt.jsx)(jt,{value:!0,children:"Yes"}),Object(bt.jsx)(jt,{value:!1,children:"No"})]})]})}),Object(bt.jsx)("span",{className:"sep-1"}),Object(bt.jsx)("div",{className:"mv-sidebar-block",children:Object(bt.jsxs)("div",{className:"mv-sidebar-tooltip-grid",children:[Object(bt.jsx)(cn,{onCheck:function(e){c.useNMRIsotopes=e},checked:c.useNMRIsotopes,children:"Use only NMR active isotopes"}),Object(bt.jsx)(un,{tooltipText:pn})]})})]}),Object(bt.jsx)("h4",{children:"Files loaded:"}),Object(bt.jsx)(rn,{selected:s.list_selected,onSelect:function(e){i(Object(M.a)(Object(M.a)({},s),{},{list_selected:e})),c.display(e)},children:r.map((function(e,t){var n;return n=e===c.currentModelName?Object(bt.jsx)($t.a,{size:22}):Object(bt.jsx)($t.b,{size:22,onClick:function(){c.display(e)}}),Object(bt.jsxs)(ln,{value:e,icon:n,children:[e,Object(bt.jsx)(en.a,{style:{color:"var(--dark-color-1)"},size:22,onClick:function(){c.reload(e)}}),Object(bt.jsx)(tn.a,{style:{color:"var(--err-color-2)"},size:22,onClick:function(){c.delete(e)}})]},t)}))}),Object(bt.jsx)("span",{className:"sep-1"}),Object(bt.jsx)(sn,{status:s.load_message_status,onClose:function(){i(Object(M.a)(Object(M.a)({},s),{},{load_message_status:""}))},children:s.load_message})]})};n(266),n(267);var jn=function(e){return Object(bt.jsx)("div",{className:"mv-control",children:Object(bt.jsx)("button",Object(M.a)(Object(M.a)({},e),{},{className:"mv-control mv-button",children:e.children}))})};n(268);function mn(e){var t=u("radiobutton");return Object(bt.jsxs)("span",{className:"mv-control mv-radio",title:e.title,children:[Object(bt.jsx)("input",{id:t,name:e.name,type:"radio",checked:e.checked,onChange:e.onChange}),Object(bt.jsx)("label",{htmlFor:t}),e.children]})}function vn(e){var t=o.a.filter(e.children,(function(e){return e.type===mn})),n=t.map((function(e){return e.props.value})).findIndex((function(t){return t===e.selected})),s=e.onSelect?e.onSelect:function(){},i={};return e.color&&(i["--check-color"]=e.color),Object(bt.jsxs)("span",{className:"mv-control mv-radiogroup",style:i,title:e.title,children:[e.label?Object(bt.jsx)("span",{className:"mv-radiogroup-label",style:e.labelStyle,children:e.label}):null,t.map((function(t,i){return Object(a.cloneElement)(t,{key:i,index:i,checked:i===n,name:e.name,onChange:function(e){s(t.props.value)}})}))]})}var _n=mn;n(129);var On=function(e){var t=Object(a.useState)(!0),n=Object(l.a)(t,2),s=n[0],i=n[1],c=u("text"),r=null;e.filter&&(r=new RegExp(e.filter));var o={};e.color&&(o["--outline-color"]=e.color);var h=e.onSubmit&&!s;return Object(bt.jsxs)("span",{className:"mv-text",style:o,title:e.title,children:[e.children?Object(bt.jsx)("label",{htmlFor:c,className:"mv-textlabel",children:e.children}):Object(bt.jsx)(bt.Fragment,{}),Object(bt.jsx)("input",{type:"text",id:c,className:d("mv-control mv-textfield",h?"mv-submit-wait":""),size:e.size,value:e.value,onChange:function(t){var n=t.target.value;if(r){var a=r.exec(n);n=a?a[0]:e.value}i(!1),e.onChange&&e.onChange(n)},onKeyDown:function(t){"Enter"===t.key&&(h&&e.onSubmit(e.value),i(!0))},disabled:e.disabled})]})};function gn(e){var t=Object(a.useState)(1),n=Object(l.a)(t,2),s=n[0],i=n[1],c=Oe(),r=c.selected,d=function(e){if(null==e||0===e.atoms.length)return null;var t=e.atoms,n=t[0].element;return t.slice(1).reduce((function(e,t){return e&&t.element===n}),!0)?n:null}(r),u=null,h=null,p=[],f=0;if(d){u=r.atoms[0].elementData,f=(h=r.atoms.map((function(e){return e.isotope})))[0].toString(),h.reduce((function(e,t){return e&&t===h[0]}),!0)||(p=[Object(bt.jsx)(jt,{value:h,children:o.a.join(o.a.uniq(h))},-1)],f=h);var b=Object.keys(u.isotopes).sort();p=p.concat(b.map((function(e,t){return Object(bt.jsx)(jt,{value:e,children:e},t)})))}else p=[Object(bt.jsx)(jt,{value:0,children:"N/A"},0)];return Object(bt.jsxs)(bt.Fragment,{children:[Object(bt.jsx)("h3",{children:"Isotope selection"}),Object(bt.jsx)(mt,{disabled:!d,onSelect:function(e){c.setIsotope(e),i(-s)},selected:f,children:p})]})}var yn=function(e){var t=Oe();function n(e){t.selectionSphereR=e}function s(e){t.selectionBondN=e}console.log("[MVSidebarSelect rendered]");var i=Object(a.useRef)();return i.current=t,Object(a.useEffect)((function(){console.log("Binding select clicks"),i.current.selectionOn=e.show}),[e.show,t.app]),Object(bt.jsxs)(Xt,{show:e.show,title:"Select and display",children:[Object(bt.jsxs)("div",{className:"mv-sidebar-block",children:[Object(bt.jsx)(cn,{checked:t.highlightSelected,onCheck:function(e){t.highlightSelected=e},children:"Highlight selected"}),Object(bt.jsx)(cn,{checked:t.showCell,onCheck:function(e){t.showCell=e},children:"Show unit cell"}),Object(bt.jsx)("span",{className:"sep-1"}),Object(bt.jsx)("h4",{children:"Label by"}),Object(bt.jsxs)(mt,{onSelect:function(e){!function(e){t.labelMode=e}(e)},selected:t.labelMode,name:"label_mode_dropdown",children:[Object(bt.jsx)(jt,{value:"none",children:"None"}),Object(bt.jsx)(jt,{value:"labels",children:"Crystallographic labels"}),Object(bt.jsx)(jt,{value:"element",children:"Element"}),Object(bt.jsx)(jt,{value:"isotope",children:"Isotope"})]}),Object(bt.jsx)("span",{className:"sep-1"}),Object(bt.jsxs)(vn,{label:"Selection mode",onSelect:function(e){t.selectionMode=e},selected:t.selectionMode,name:"selec_mode_radio",children:[Object(bt.jsx)(_n,{value:"atom",children:"Atom"}),Object(bt.jsx)(_n,{value:"element",children:"Element"}),Object(bt.jsx)(_n,{value:"label",children:"Crystallographic label"}),Object(bt.jsxs)(_n,{value:"sphere",children:["Sphere, radius =\xa0",Object(bt.jsx)(On,{size:"5",value:t.selectionSphereR,filter:"[0-9]*(?:\\.[0-9]*)?",onChange:n,onSubmit:n}),"\xa0  \u212b"]}),Object(bt.jsx)(_n,{value:"molecule",children:"Molecule"}),Object(bt.jsxs)(_n,{value:"bonds",children:["Bonds, max distance = \xa0",Object(bt.jsx)(On,{size:"3",value:t.selectionBondN,filter:"[0-9]*",onChange:s,onSubmit:s})]})]})]}),Object(bt.jsx)("span",{className:"sep-1"}),Object(bt.jsx)("div",{className:"mv-sidebar-block",children:Object(bt.jsxs)("div",{className:"mv-sidebar-grid",children:[Object(bt.jsx)(jn,{onClick:function(){t.selected=t.displayed},children:"Select visible"}),Object(bt.jsx)(jn,{onClick:function(){t.selected=null},children:"Select none"}),Object(bt.jsx)(jn,{onClick:function(){t.displayed=t.selected},children:"Display selected"}),Object(bt.jsx)(jn,{onClick:function(){t.displayed=null},children:"Reset displayed"})]})}),Object(bt.jsx)("span",{className:"sep-1"}),Object(bt.jsx)("div",{className:"mv-sidebar-block",children:Object(bt.jsx)(gn,{})}),Object(bt.jsxs)("div",{className:"mv-sidebar-block",children:[Object(bt.jsx)("h3",{children:"Selection controls:"}),Object(bt.jsxs)("ul",{children:[Object(bt.jsxs)("li",{children:[Object(bt.jsx)("tt",{children:"CLICK"})," to select an atom/element/etc."]}),Object(bt.jsxs)("li",{children:[Object(bt.jsx)("tt",{children:"SHIFT+CLICK"})," to add to the current selection"]}),Object(bt.jsxs)("li",{children:[Object(bt.jsx)("tt",{children:"CTRL+CLICK"})," to add or remove (XOR) from the current selection"]})]})]})]})};n(269),n(270);var xn=function(e){var t="min"in e?e.min:0,n="max"in e?e.max:100,s="default"in e?e.default:(t+n)/2,i="step"in e?e.step:1;function c(e){return e=parseFloat(e),e=parseFloat(e.toFixed(6))}var r=null!=e.value?c(e.value):s,o=u("range"),d=Object(a.useState)(r.toString()),h=Object(l.a)(d,2),p=h[0],f=h[1],b={};function j(t){t=c(t),e.onChange&&e.onChange(t)}e.color&&(b["--outline-color"]=e.color,b["--thumb-color"]=e.color);var m=Object(a.useRef)();return m.current=[p,f],Object(a.useEffect)((function(){var e=Object(l.a)(m.current,2),t=e[0],n=e[1];parseFloat(t)!==r&&n(r.toString())}),[r]),Object(bt.jsxs)("div",{className:"mv-control",children:[e.children?Object(bt.jsx)("label",{htmlFor:o,className:"mv-rangelabel",children:e.children}):Object(bt.jsx)(bt.Fragment,{}),Object(bt.jsxs)("span",{className:"mv-control mv-range",style:b,children:[Object(bt.jsx)("input",{className:"mv-range-slider",type:"range",id:o,onInput:function(e){j(e.target.value)},min:t,max:n,step:i,value:r,disabled:e.disabled}),Object(bt.jsx)(On,{size:4,filter:x.float,value:p,onChange:f,onSubmit:j,disabled:e.disabled})]})]})},kn=(n(271),n(0)),wn=n(172);function Sn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"dragstart":e=Object(M.a)(Object(M.a)({},e),{},{is_drag:!0,x0:t.x0,y0:t.y0});break;case"move":e=Object(M.a)(Object(M.a)({},e),{},{dx:t.dx-e.x0,dy:t.dy-e.y0});break;case"dragend":e=Object(M.a)(Object(M.a)({},e),{},{is_drag:!1,x0:null,y0:null})}return e}var En=function(e){var t=Object(a.useReducer)(Sn,{dx:0,dy:0,x0:null,y0:null,is_drag:!1}),n=Object(l.a)(t,2),s=n[0],i=n[1],c=e.onAccept||function(){},r=e.onClose||function(){};Object(a.useEffect)((function(){s.is_drag?(document.onmousemove=function(e){i({type:"move",dx:e.clientX,dy:e.clientY})},document.onmouseup=function(e){i({type:"dragend"})}):(document.onmousemove=null,document.onmouseup=null)}),[s.is_drag]);var o={transform:"translate("+s.dx+"px, "+s.dy+"px)"},u=e.hasOverlay;u||e.display||(o.display="none");var h=Object(bt.jsxs)("div",{className:d("mv-control mv-modal",e.draggable?"mv-modal-draggable":"",e.resizable?"mv-modal-resizable":""),style:o,children:[Object(bt.jsxs)("div",{className:"mv-modal-title",onMouseDown:function(t){e.draggable&&0===t.button&&i({type:"dragstart",x0:t.clientX-s.dx,y0:t.clientY-s.dy})},children:[e.title,Object(bt.jsx)(kn.b.Provider,{value:{color:"var(--fwd-color-1)"},children:Object(bt.jsx)(wn.a,{size:22,onClick:r})})]}),Object(bt.jsx)("div",{className:"mv-modal-content",children:e.children}),e.noFooter?Object(bt.jsx)(bt.Fragment,{}):Object(bt.jsxs)("div",{className:"mv-modal-footer",children:[Object(bt.jsx)(jn,{onClick:c,children:"OK"}),Object(bt.jsx)(jn,{onClick:r,children:"Cancel"})]})]});return u&&(h=Object(bt.jsx)("div",{className:d("mv-control mv-modal-overlay",e.display?"":"mv-modal-hidden"),children:h})),h};n(272);function Cn(e,t,n,a){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(s)return null;for(var i=11,c=b()({colormap:a,nshades:i,format:"hex",alpha:1}),l=new m.a(0,1,c,1),r=[],o=[],d=[],u=Array.from(Array(i).keys()).map((function(e){return e/(i-1)})),h=u.map((function(e){return l.getColor(e).toHexString()})),p=0,f=(h.length-1)/2,j=h.length-1,v=0;v<h.length;v++){var _=v.toString();r.push(Object(bt.jsx)("td",{className:"mv-cscale-bar",style:{backgroundColor:h[v]}},"c"+v)),v===p||v===f||v===j?o.push(Object(bt.jsx)("td",{className:"mv-cscale-tick",children:"|"},"t"+_)):o.push(Object(bt.jsx)("td",{className:"mv-cscale-tick"},"t"+_)),d.push(Object(bt.jsx)("td",{className:"mv-cscale-tick-label"},"l"+_))}return d[p]=Object(bt.jsx)("td",{className:"mv-cscale-tick-label",children:e.toFixed(2)},"l0"),d[f]=Object(bt.jsx)("td",{className:"mv-cscale-tick-label",children:((e+t)/2).toFixed(2)},"l"+((d.length-1)/2).toString()),d[j]=Object(bt.jsx)("td",{className:"mv-cscale-tick-label",children:t.toFixed(2)+" "+n},"l"+(d.length-1).toString()),Object(bt.jsx)("table",{className:"mv-cscale-table",children:Object(bt.jsxs)("tbody",{children:[Object(bt.jsx)("tr",{children:r}),Object(bt.jsx)("tr",{children:o}),Object(bt.jsx)("tr",{children:d})]})})}var Ln=function(e){return Object(bt.jsx)("div",{className:"mv-cscalebar",children:Cn(e.lims[0],e.lims[1],e.units,e.cmap,e.hidden)})};function Nn(e){var t=Ie(),n=Object(a.useState)(t.referenceTable),s=Object(l.a)(n,2),i=s[0],c=s[1],r=Object(a.useRef)();r.current=t,Object(a.useEffect)((function(){c(r.current.referenceTable)}),[e.display]);var d=o.a.keys(i).sort();return Object(bt.jsx)(En,{title:"References for chemical shifts, by element (ppm)",display:e.display,hasOverlay:!0,onClose:e.close,onAccept:function(){t.updateReferenceTable(i),e.close()},children:Object(bt.jsx)("div",{className:"mv-msref-table",children:d.map((function(e,t){var n=i[e];return Object(bt.jsxs)("div",{className:"mv-msref-table-row",children:[Object(bt.jsx)("div",{className:"mv-msref-table-el",children:e}),Object(bt.jsx)("div",{className:"mv-msref-table-ref",children:Object(bt.jsx)(On,{value:n,onChange:function(t){c(Object(M.a)(Object(M.a)({},i),{},Object(A.a)({},e,t)))},size:5})}),Object(bt.jsx)("div",{className:"mv-msref-table-copy",children:Object(bt.jsx)(jn,{onClick:function(){var e;e=n,c(o.a.fromPairs(d.map((function(t){return[t,e]}))))},children:"Apply to all"})})]},t)}))})})}var In=function(e){var t=Object(a.useState)({showRefTable:!1}),n=Object(l.a)(t,2),s=n[0],i=n[1],c=Ie();console.log("[MVSidebarMS rendered]");var r=!1;return e.show&&(r=c.hasData),Object(bt.jsxs)(Xt,{show:e.show,title:"Magnetic Shielding",children:[Object(bt.jsxs)("div",{className:d("mv-sidebar-block",r?"":"hidden"),children:[Object(bt.jsx)(cn,{onCheck:function(e){c.hasEllipsoids=e},checked:c.hasEllipsoids,children:"Ellipsoids"}),Object(bt.jsx)(xn,{min:.01,max:.5,step:.005,value:c.ellipsoidScale,onChange:function(e){c.ellipsoidScale=e},disabled:!c.hasEllipsoids,children:"Ellipsoid scale"}),Object(bt.jsx)(jn,{onClick:function(){c.ellipsoidScale=0},disabled:!c.hasEllipsoids,children:"Auto scale"}),Object(bt.jsx)(jn,{onClick:function(){i(Object(M.a)(Object(M.a)({},s),{},{showRefTable:!0}))},children:"Set References"}),Object(bt.jsx)(Nn,{display:s.showRefTable,close:function(){i(Object(M.a)(Object(M.a)({},s),{},{showRefTable:!1}))}}),Object(bt.jsxs)(vn,{label:"Show labels",onSelect:function(e){c.labelsMode=e},selected:c.labelsMode,name:"ms_label_radio",children:[Object(bt.jsx)(_n,{value:"none",children:"None"}),Object(bt.jsx)(_n,{value:"iso",children:"Isotropy (ppm)"}),Object(bt.jsx)(_n,{value:"cs",children:"Chemical Shifts (ppm, uses references)"}),Object(bt.jsx)(_n,{value:"aniso",children:"Anisotropy (ppm)"}),Object(bt.jsx)(_n,{value:"redaniso",children:"Reduced Anisotropy (ppm)"}),Object(bt.jsx)(_n,{value:"asymm",children:"Asymmetry"})]}),Object(bt.jsx)(xn,{min:0,max:6,step:1,value:c.precision,onChange:function(e){c.precision=e},disabled:"none"===c.labelsMode,children:"Label Precision"}),Object(bt.jsxs)(vn,{label:"Use color scale",onSelect:function(e){c.colorScaleType=e},selected:c.colorScaleType,disabled:!c.colorScaleAvailable,name:"ms_cscale_radio",children:[Object(bt.jsx)(_n,{value:"none",children:"None"}),Object(bt.jsx)(_n,{value:"ms_iso",children:"Isotropy"}),Object(bt.jsx)(_n,{value:"ms_cs",children:"Chemical Shifts (uses references)"}),Object(bt.jsx)(_n,{value:"ms_aniso",children:"Anisotropy"}),Object(bt.jsx)(_n,{value:"ms_asymm",children:"Asymmetry"})]}),Object(bt.jsx)(Ln,{label:c.colorScaleType,hidden:"none"===c.colorScaleType,lims:c.colorScaleLimits,cmap:c.colorScaleCmap,units:c.colorScaleUnits}),"Color map",Object(bt.jsxs)(mt,{onSelect:function(e){c.colorScaleCmap=e},selected:c.colorScaleCmap,name:"cmap_dropdown",children:[Object(bt.jsx)(jt,{value:"viridis",children:"Viridis"}),Object(bt.jsx)(jt,{value:"portland",children:"Portland"}),Object(bt.jsx)(jt,{value:"RdBu",children:"Red-Blue"}),Object(bt.jsx)(jt,{value:"inferno",children:"Inferno"}),Object(bt.jsx)(jt,{value:"jet",children:"Jet"})]}),Object(bt.jsx)(jn,{onClick:function(){c.reset()},children:"Reset options"})]}),Object(bt.jsx)("div",{className:d("mv-warning-noms",r?"hidden":""),children:"No MS data found"})]})};n(273);var An=function(e){var t=De();console.log("[MVSidebarEFG rendered]");var n=!1;return e.show&&(n=t.hasData),Object(bt.jsxs)(Xt,{show:e.show,title:"Electric Field Gradient",children:[Object(bt.jsxs)("div",{className:d("mv-sidebar-block",n?"":"hidden"),children:[Object(bt.jsx)(cn,{onCheck:function(e){t.hasEllipsoids=e},checked:t.hasEllipsoids,color:"var(--efg-color-2)",children:"Ellipsoids"}),Object(bt.jsx)(xn,{min:.1,max:10,step:.05,value:t.ellipsoidScale,color:"var(--efg-color-2)",onChange:function(e){t.ellipsoidScale=e},disabled:!t.hasEllipsoids,children:"Ellipsoid scale"}),Object(bt.jsx)(jn,{onClick:function(){t.ellipsoidScale=0},disabled:!t.hasEllipsoids,children:"Auto scale"}),Object(bt.jsxs)(vn,{label:"Show labels",onSelect:function(e){t.labelsMode=e},selected:t.labelsMode,name:"efg_label_radio",color:"var(--efg-color-2)",children:[Object(bt.jsx)(_n,{value:"none",children:"None"}),Object(bt.jsx)(_n,{value:"Q",children:"Quadrupole Coupling"}),Object(bt.jsx)(_n,{value:"e_z",children:"Vzz (au)"}),Object(bt.jsx)(_n,{value:"asymm",children:"Asymmetry"})]}),Object(bt.jsx)(xn,{min:0,max:6,step:1,value:t.precision,onChange:function(e){t.precision=e},disabled:"none"===t.labelsMode,children:"Label Precision"}),Object(bt.jsxs)(vn,{label:"Use color scale",onSelect:function(e){t.colorScaleType=e},selected:t.colorScaleType,disabled:!t.colorScaleAvailable,name:"efg_cscale_radio",color:"var(--efg-color-2)",children:[Object(bt.jsx)(_n,{value:"none",children:"None"}),Object(bt.jsx)(_n,{value:"efg_Q",children:"|Quadrupole Coupling|"}),Object(bt.jsx)(_n,{value:"efg_e_z",children:"Vzz"}),Object(bt.jsx)(_n,{value:"efg_asymm",children:"Asymmetry"})]}),Object(bt.jsx)(Ln,{label:t.colorScaleType,hidden:"none"===t.colorScaleType,lims:t.colorScaleLimits,units:t.colorScaleUnits,cmap:t.colorScaleCmap}),"Color map",Object(bt.jsxs)(mt,{onSelect:function(e){t.colorScaleCmap=e},selected:t.colorScaleCmap,name:"cmap_dropdown",children:[Object(bt.jsx)(jt,{value:"viridis",children:"Viridis"}),Object(bt.jsx)(jt,{value:"portland",children:"Portland"}),Object(bt.jsx)(jt,{value:"RdBu",children:"Red-Blue"}),Object(bt.jsx)(jt,{value:"inferno",children:"Inferno"}),Object(bt.jsx)(jt,{value:"jet",children:"Jet"})]}),Object(bt.jsx)(jn,{onClick:function(){t.reset()},children:"Reset options"})]}),Object(bt.jsx)("div",{className:d("mv-warning-noms",n?"hidden":""),children:"No EFG data found"})]})};n(274);var Mn=function(e){var t=ze();console.log("[MVSidebarDip rendered]");var n=Object(a.useRef)();return n.current=t,Object(a.useEffect)((function(){var t=n.current;e.show&&t.isOn?t.bind():t.unbind()}),[e.show,t.isOn]),Object(bt.jsxs)(Xt,{show:e.show,title:"Dipolar couplings",children:[Object(bt.jsx)("div",{className:"mv-sidebar-block",children:Object(bt.jsx)(cn,{color:"var(--dip-color-3)",onCheck:function(e){t.isOn=e},checked:t.isOn,children:"Show dipolar couplings"})}),Object(bt.jsxs)("div",{className:"mv-sidebar-block",children:[Object(bt.jsx)("p",{children:"Click on an atom to show all dipolar couplings in a selected radius. (Note: to avoid performance issues, changing the radius of selection has effect only from the next click)"}),Object(bt.jsx)(xn,{min:1,max:20,step:.05,value:t.radius,color:"var(--dip-color-3)",onChange:function(e){t.radius=e},children:"Selection radius / \u212b"}),Object(bt.jsx)(cn,{color:"var(--dip-color-3)",onCheck:function(e){t.showSphere=e},checked:t.showSphere,children:"Show selection sphere"}),Object(bt.jsx)(cn,{color:"var(--dip-color-3)",onCheck:function(e){t.homonuclearOnly=e},checked:t.homonuclearOnly,children:"Show only homonuclear couplings"}),Object(bt.jsx)(xn,{min:0,max:6,step:1,value:t.precision,onChange:function(e){t.precision=e},disabled:!t.isOn,children:"Label Precision"}),Object(bt.jsx)(jn,{onClick:function(){t.reset()},children:"Reset options"})]})]})};n(275);var Rn=function(e){var t=Je();console.log("[MVSidebarJCoup rendered]");var n=Object(a.useRef)();n.current=t,Object(a.useEffect)((function(){var t=n.current;e.show&&t.isOn?t.bind():t.unbind()}),[e.show,t.isOn]);var s=!1;return e.show&&(s=t.hasData),Object(bt.jsxs)(Xt,{show:e.show,title:"J couplings",children:[Object(bt.jsxs)("div",{className:s?"":"hidden",children:[Object(bt.jsx)("div",{className:"mv-sidebar-block",children:Object(bt.jsx)(cn,{color:"var(--jcoup-color-3)",onCheck:function(e){t.isOn=e},checked:t.isOn,children:"Show J couplings"})}),Object(bt.jsxs)("div",{className:"mv-sidebar-block",children:[Object(bt.jsx)("p",{children:"Choose Click on an atom to show all J couplings in a selected radius. (Note: to avoid performance issues, changing the radius of selection has effect only from the next click)"}),Object(bt.jsx)(xn,{min:1,max:20,step:.05,value:t.radius,color:"var(--jcoup-color-3)",onChange:function(e){t.radius=e},children:"Selection radius / \u212b"}),Object(bt.jsx)(cn,{color:"var(--jcoup-color-3)",onCheck:function(e){t.showSphere=e},checked:t.showSphere,children:"Show selection sphere"}),Object(bt.jsx)(cn,{color:"var(--jcoup-color-3)",onCheck:function(e){t.homonuclearOnly=e},checked:t.homonuclearOnly,children:"Show only homonuclear couplings"}),Object(bt.jsx)(xn,{min:0,max:6,step:1,value:t.precision,onChange:function(e){t.precision=e},disabled:!t.isOn,children:"Label Precision"}),Object(bt.jsx)(jn,{onClick:function(){t.reset()},children:"Reset options"})]})]}),Object(bt.jsx)("div",{className:d("mv-warning-noms",s?"hidden":""),children:"No J coupling data found in file (lines beginning isc)"})]})};n(276),n(277);var Dn=function(e){var t={"--color-true":e.colorTrue||"var(--ok-color-2)","--color-false":e.colorFalse||"var(--err-color-2)"},n=e.onClick||function(){};return Object(bt.jsx)("div",{className:d("mv-control mv-switch",e.on?"mv-switch-true":"mv-switch-false"),style:t,onClick:n,children:Object(bt.jsx)("div",{className:"mv-switch-thumb"})})};var Fn=function(e){var t=Xe();console.log("[MVSidebarEuler rendered]");var n=Object(a.useRef)();n.current=t,Object(a.useEffect)((function(){var t=n.current;e.show?t.bind():t.unbind()}),[e.show]);var s={ms:"efg",efg:"ms"},i=t.alpha,c=t.beta,l=t.gamma;"N/A"!==i&&(i=i.toFixed(2),c=c.toFixed(2),l=l.toFixed(2));var r=t.atomA&&t.atomB;return Object(bt.jsxs)(Xt,{show:e.show,title:"Euler angles",children:[Object(bt.jsx)("p",{children:"Left and right click on atoms to pick a pair of atoms, A and B respectively (which can be the same). Use the switches below to select the pair of tensors of interest."}),Object(bt.jsxs)("div",{className:"mv-sidebar-block",children:[Object(bt.jsx)("h3",{children:"Atom A"}),Object(bt.jsxs)("div",{className:"mv-euler-agrid",children:[Object(bt.jsx)("span",{className:"header",children:"Label:"}),Object(bt.jsx)("span",{children:t.atomLabelA}),Object(bt.jsxs)("div",{className:"mv-euler-agrid-switch",children:[Object(bt.jsx)("span",{children:"Shielding"}),Object(bt.jsx)(Dn,{on:"efg"===t.tensorA,onClick:function(){t.tensorA=s[t.tensorA]},colorFalse:"var(--ms-color-2)",colorTrue:"var(--efg-color-2)"}),Object(bt.jsx)("span",{children:"EFG"})]})]})]}),Object(bt.jsxs)("div",{className:"mv-sidebar-block",children:[Object(bt.jsx)("h3",{children:"Atom B"}),Object(bt.jsxs)("div",{className:"mv-euler-agrid",children:[Object(bt.jsx)("span",{className:"header",children:"Label:"}),Object(bt.jsx)("span",{children:t.atomLabelB}),Object(bt.jsxs)("div",{className:"mv-euler-agrid-switch",children:[Object(bt.jsx)("span",{children:"Shielding"}),Object(bt.jsx)(Dn,{on:"efg"===t.tensorB,onClick:function(){t.tensorB=s[t.tensorB]},colorFalse:"var(--ms-color-2)",colorTrue:"var(--efg-color-2)"}),Object(bt.jsx)("span",{children:"EFG"})]})]})]}),Object(bt.jsxs)("div",{className:"mv-sidebar-block",children:[Object(bt.jsx)("h3",{children:"Convention"}),Object(bt.jsxs)(mt,{selected:t.convention,onSelect:function(e){t.convention=e},children:[Object(bt.jsx)(jt,{value:"zyz",children:"ZYZ"}),Object(bt.jsx)(jt,{value:"zxz",children:"ZXZ"})]})]}),Object(bt.jsxs)("div",{className:"mv-sidebar-block",children:[Object(bt.jsx)("h3",{children:"Angles"}),Object(bt.jsxs)("table",{className:"mv-eul-results",children:[Object(bt.jsx)("thead",{children:Object(bt.jsxs)("tr",{children:[Object(bt.jsx)("td",{children:"Alpha"}),Object(bt.jsx)("td",{children:"Beta"}),Object(bt.jsx)("td",{children:"Gamma"})]})}),Object(bt.jsx)("tbody",{children:Object(bt.jsxs)("tr",{children:[Object(bt.jsxs)("td",{children:[i,"\xb0"]}),Object(bt.jsxs)("td",{children:[c,"\xb0"]}),Object(bt.jsxs)("td",{children:[l,"\xb0"]})]})})]})]}),Object(bt.jsx)("span",{className:"sep-1"}),Object(bt.jsx)("div",{className:"mv-sidebar-block",children:Object(bt.jsxs)(jn,{onClick:function(){var e;e=t.txtReport(),navigator.clipboard.writeText(e)},disabled:!r,children:[Object(bt.jsx)(pt.e,{}),"\xa0Copy to clipboard"]})}),Object(bt.jsx)("div",{className:"mv-sidebar-block",children:Object(bt.jsx)(jn,{onClick:function(){g("data:,"+t.txtSelfAngleTable(),"eulerTable.txt")},disabled:!(t.hasMSData&&t.hasEFGData),children:"Download table of MS-to-EFG angles"})})]})};n(278);var Tn=function(e){var t=ct();return Object(bt.jsxs)(Xt,{show:e.show,title:"Spectral plots",children:[Object(bt.jsx)("div",{className:"mv-sidebar-block",children:Object(bt.jsxs)(vn,{label:"Plot mode",selected:t.mode,onSelect:function(e){t.mode=e},children:[Object(bt.jsx)(_n,{value:"none",children:"None"}),Object(bt.jsx)(_n,{value:"bars-1d",children:"1D, bars"}),Object(bt.jsx)(_n,{value:"line-1d",children:"1D, Lorentzian broadening"})]})}),Object(bt.jsx)("div",{className:"mv-sidebar-block",children:Object(bt.jsx)(cn,{checked:t.useRefTable,onCheck:function(e){t.useRefTable=e},children:"Show chemical shifts (use references)"})}),Object(bt.jsxs)("div",{className:"mv-sidebar-grid",children:[Object(bt.jsx)(cn,{checked:t.showAxes,onCheck:function(e){t.showAxes=e},children:"Show axes"}),Object(bt.jsx)(cn,{checked:t.showGrid,onCheck:function(e){t.showGrid=e},children:"Show grid"})]}),Object(bt.jsx)("div",{className:"mv-sidebar-grid",children:Object(bt.jsx)(cn,{checked:t.showLabels,onCheck:function(e){t.showLabels=e},children:"Show labels"})}),Object(bt.jsx)("span",{className:"sep-1"}),Object(bt.jsxs)("div",{className:"mv-sidebar-row",style:{alignItems:"center"},children:["X range: \xa0",Object(bt.jsx)(On,{size:"5",value:t.rangeX[0],onChange:function(e){t.setRange(e)},filter:"[\\-]*[0-9]*(?:\\.[0-9]*)?"})," \xa0 to \xa0",Object(bt.jsx)(On,{size:"5",value:t.rangeX[1],onChange:function(e){t.setRange(null,e)},filter:"[\\-]*[0-9]*(?:\\.[0-9]*)?"})]}),Object(bt.jsx)("span",{className:"sep-1"}),Object(bt.jsxs)("div",{className:"mv-sidebar-row",style:{alignItems:"center"},children:["Y range: \xa0",Object(bt.jsx)(On,{size:"5",value:t.rangeY[0],onChange:function(e){t.setRange(e,null,"y")},filter:"[\\-]*[0-9]*(?:\\.[0-9]*)?"})," \xa0 to \xa0",Object(bt.jsx)(On,{size:"5",value:t.rangeY[1],onChange:function(e){t.setRange(null,e,"y")},filter:"[\\-]*[0-9]*(?:\\.[0-9]*)?"})]}),Object(bt.jsx)("span",{className:"sep-1"}),Object(bt.jsxs)("div",{className:"mv-sidebar-row",style:{alignItems:"center"},children:["Peak width: \xa0",Object(bt.jsx)(On,{size:"3",value:t.peakW,onChange:function(e){t.peakW=e},filter:"[\\-]*[0-9]*(?:\\.[0-9]*)?"})," \xa0 ppm"]}),Object(bt.jsx)("span",{className:"sep-1"}),Object(bt.jsxs)("div",{className:"mv-sidebar-row",style:{alignItems:"center"},children:["X steps: \xa0",Object(bt.jsx)(On,{size:"3",value:t.xSteps,onChange:function(e){t.xSteps=e},filter:"[\\-]*[0-9]*(?:\\.[0-9]*)?"})]}),Object(bt.jsx)("span",{className:"sep-1"}),Object(bt.jsxs)("div",{className:"mv-sidebar-grid",children:[Object(bt.jsx)(jn,{onClick:function(){t.downloadSVG()},disabled:"none"===t.mode,children:"Download SVG"}),Object(bt.jsx)(jn,{onClick:function(){t.downloadData()},disabled:"none"===t.mode,children:"Download data (.csv)"})]})]})};n(279);function Pn(e){return Object(bt.jsxs)("div",{className:".mv-sidebar-grid",children:[Object(bt.jsx)("h4",{children:"Quadrupole order:"}),Object(bt.jsxs)(mt,{selected:e.spinSysQuadrupoleOrder,onSelect:function(t){e.spinSysQuadrupoleOrder=t},children:[Object(bt.jsx)(jt,{value:0,children:"0"}),Object(bt.jsx)(jt,{value:1,children:"1"}),Object(bt.jsx)(jt,{value:2,children:"2"})]})]})}function zn(e){return Object(bt.jsxs)("div",{className:".mv-sidebar-grid",children:[Object(bt.jsx)("h3",{children:"Include:"}),Object(bt.jsx)(cn,{checked:e.spinSysIncludeMS,onCheck:function(t){e.spinSysIncludeMS=t},children:"MS tensors"}),Object(bt.jsx)(cn,{checked:e.spinSysIncludeEFG,onCheck:function(t){e.spinSysIncludeEFG=t},children:"EFG tensors"}),Object(bt.jsx)(cn,{checked:e.spinSysIncludeD,onCheck:function(t){e.spinSysIncludeD=t},children:"Dipolar couplings"}),e.spinSysIncludeEFG?Pn(e):null]})}var Bn=function(e){var t=rt();return Object(bt.jsx)(Xt,{title:"Report files",show:e.show,children:Object(bt.jsxs)("div",{className:"mv-sidebar-block",children:[Object(bt.jsx)("h3",{children:"File type:"}),Object(bt.jsxs)(mt,{selected:t.fileType,onSelect:function(e){t.fileType=e},children:[Object(bt.jsx)(jt,{value:"ms",icon:Object(bt.jsx)(Zt,{icon:"ms",color:"var(--ms-color-3)"}),children:"MS table"}),Object(bt.jsx)(jt,{value:"efg",icon:Object(bt.jsx)(Zt,{icon:"efg",color:"var(--efg-color-3)"}),children:"EFG table"}),Object(bt.jsx)(jt,{value:"dip",icon:Object(bt.jsx)(Zt,{icon:"dip",color:"var(--dip-color-3)"}),children:"Dipolar coupling table"}),Object(bt.jsx)(jt,{value:"isc",icon:Object(bt.jsx)(Zt,{icon:"jcoup",color:"var(--jcoup-color-3)"}),children:"J coupling table"}),Object(bt.jsx)(jt,{value:"spinsys",icon:Object(bt.jsx)(ft.b,{style:{color:"var(--spinsys-color-3)"}}),children:"SpinSys"})]}),"spinsys"===t.fileType?zn(t):null,Object(bt.jsx)(jn,{onClick:function(){var e,n;e=t.generateFile(),n=t.fileName,g("data:,"+e,n)},disabled:!t.fileValid,children:"Save file"})]})})},Gn=n(178),Vn=(n(385),20),Jn=Math.pow(12.5,2);var Kn=function(e){var t=Object(a.useState)(-1),n=Object(l.a)(t,2),s=n[0],i=n[1],c=e.margins||{},r=e.image||{},o=[[c.left,r.height-c.bottom],[c.left,c.top],[r.width-c.right,r.height-c.bottom]],u=e.setMargins||function(){};return Object(bt.jsxs)("g",{className:"img-layer",transform:"translate(-"+c.left+",-"+c.top+")",onClick:function(e){var t=e.clientX,n=e.clientY,a=-1;if("image"===e.target.nodeName){var c=e.target.getBoundingClientRect();t-=c.left,n-=c.top;for(var d=0;d<o.length;++d){var h=Object(l.a)(o[d],2),p=h[0],f=h[1];if(Math.pow(t-p,2)+Math.pow(n-f,2)<=Jn){a=d;break}}}else if("rect"===e.target.nodeName){var b=e.target.parentElement.className.baseVal.trim();if(!((a=["img-margin-origin","img-margin-top","img-margin-right"].indexOf(b))>=0))return;var j=Object(l.a)(o[a],2);t=j[0],n=j[1]}if(s<0)i(a);else{if(-1===a)switch(s){case 0:u({left:t,bottom:r.height-n});break;case 1:u({top:n});break;case 2:u({right:r.width-t})}i(-1)}},children:[Object(bt.jsx)("image",{href:r.url}),Object(bt.jsxs)("g",{className:"img-layer-margins",children:[Object(bt.jsxs)("g",{className:d("img-margin-origin",0===s?"selected":""),transform:"translate("+o[0][0]+","+o[0][1]+")",children:[Object(bt.jsx)("rect",{x:-2.5,y:-10,width:5,height:Vn}),Object(bt.jsx)("rect",{x:-10,y:-2.5,width:Vn,height:5})]}),Object(bt.jsxs)("g",{className:d("img-margin-top",1===s?"selected":""),transform:"translate("+o[1][0]+","+o[1][1]+")",children:[Object(bt.jsx)("rect",{x:-2.5,y:0,width:5,height:Vn/1.5}),Object(bt.jsx)("rect",{x:-10,y:-2.5,width:Vn,height:5})]}),Object(bt.jsxs)("g",{className:d("img-margin-right",2===s?"selected":""),transform:"translate("+o[2][0]+","+o[2][1]+")",children:[Object(bt.jsx)("rect",{x:-2.5,y:-10,width:5,height:Vn}),Object(bt.jsx)("rect",{x:-20/1.5,y:-2.5,width:Vn/1.5,height:5})]})]})]})};var qn=function(e){var t=Object(a.useState)({top:20,left:50,right:20,bottom:50}),n=Object(l.a)(t,2),s=n[0],i=n[1],c=ct(),r=c.bkgImage,d=640,u=480;function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(Object(M.a)(Object(M.a)({},s),e))}r&&(d=r.width,u=r.height);var p=[function(){return r?Object(bt.jsx)(Kn,{image:r,margins:s,setMargins:h}):null},"grid","axes","areas","crosshair","lines","points","markers","slices","mesh","legends"];c.showGrid||(p=o.a.without(p,"grid")),c.showAxes||(p=o.a.without(p,"axes"));var f="none"!==c.mode,b={},j={};switch(c.mode){case"line-1d":b={enablePoints:!1,enableArea:!0},j={legend:"Intensity",legendOffset:-40,legendPosition:"middle"};break;case"bars-1d":b={pointSymbol:function(e){return Object(bt.jsx)("rect",{x:-e.size/4,width:e.size/2,height:.75*(u-(s.top+s.bottom)),color:e.borderColor,fill:e.color,strokeWidth:e.borderWidth})},pointLabelYOffset:0,lineWidth:0},j={legend:"",tickValues:0}}var m=function(e){for(var t=null,n=0,a=1e10,s=c.data[0].peaks,i=c.data[0].labels,l=0;l<s.length;l++){var r=s[l],o=Math.abs(r-e);o<a&&(a=o,t=r,n=l)}return t?{x:t,label:i[n]}:null},v=function(e){if(e)return Object(bt.jsxs)("div",{children:[Object(bt.jsx)("strong",{children:e.label}),": ",e.x.toFixed(2)," ppm"]})},_={orient:"bottom",tickSize:5,tickPadding:5,tickRotation:0,legend:c.useRefTable?"Chemical shift/ppm":"Shielding/ppm",legendOffset:36,legendPosition:"middle"};return Object(bt.jsx)(En,{title:"Spectral 1D plot",display:f,noFooter:!0,resizable:!0,draggable:!0,onClose:function(){c.mode="none"},children:Object(bt.jsx)("div",{style:{backgroundColor:"white",color:"black"},children:f?Object(bt.jsx)(Gn.a,Object(M.a)(Object(M.a)({},b),{},{isInteractive:!0,useMesh:!0,enableCrosshair:!0,xFormat:" >-.3f",yFormat:" >-.3f",width:d,height:u,colors:{scheme:"category10"},markers:function(){if(c.data.length>0&&c.showLabels){for(var e=[],t=c.data[0].peaks,n=c.data[0].labels,a=(c.floatRangeX[1]-c.floatRangeX[0])/20,s=-1e6,i="",l=5,r="",o=[],d=[],u=5,h=0;h<t.length;h++){var p=t[h];Math.abs(p-s)>a?(s=p,i=r=n[h],l=u=5):n[h]===i?(r="",u=5):(i=n[h],r=n[h],l=u=l+20),o.push(r),d.push(u)}for(var f=0;f<t.length;f++){var b=t[f];""!==o[f]&&e.push({axis:"x",value:b,lineStyle:{stroke:"var(--ms-color-2)",strokeWidth:2,opacity:.5},legend:o[f],textStyle:{fontSize:12,fill:"black",fontWeight:"bold"},legendOffsetY:d[f],legendOffsetX:-10,legendOrientation:"horizontal"})}return e}return[]}(),data:c.data,margin:s,xScale:{type:"linear",min:c.floatRangeX[0],max:c.floatRangeX[1],reverse:!!c.useRefTable},yScale:{type:"linear",min:c.floatRangeY[0],max:c.floatRangeY[1]},layers:p,axisBottom:_,axisLeft:j,motionConfig:"gentle",tooltip:function(e){var t=e.point;return Object(bt.jsxs)("div",{style:{background:"white",padding:"9px 12px",border:"1px solid #ccc"},children:[v(m(t.data.x)),Object(bt.jsx)("strong",{children:"x:"})," ",t.data.xFormatted," ",Object(bt.jsx)("br",{}),Object(bt.jsx)("strong",{children:"y:"})," ",t.data.yFormatted]})}})):null})})};function Wn(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],s=t[1],i=at(),c=Object(a.useRef)(i);return Object(a.useEffect)((function(){c.current.initialise("#mv-appwindow")}),[]),Object(bt.jsxs)("div",{className:d("mv-main-page","theme-"+i.theme,n?"has-drag":""),onDragEnter:function(e){e.preventDefault(),e.stopPropagation(),s(!0)},onDragLeave:function(e){e.preventDefault(),e.stopPropagation(),s(!1)},onDragOver:function(e){e.preventDefault(),e.stopPropagation()},onDrop:function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&e.dataTransfer.files.length>0&&(i.load(e.dataTransfer.files),e.dataTransfer.clearData()),s(!1)},children:[Object(bt.jsx)(Qt,{}),Object(bt.jsx)(bn,{show:"load"===i.sidebar}),Object(bt.jsx)(yn,{show:"select"===i.sidebar}),Object(bt.jsx)(In,{show:"ms"===i.sidebar}),Object(bt.jsx)(An,{show:"efg"===i.sidebar}),Object(bt.jsx)(Mn,{show:"dip"===i.sidebar}),Object(bt.jsx)(Rn,{show:"jcoup"===i.sidebar}),Object(bt.jsx)(Fn,{show:"euler"===i.sidebar}),Object(bt.jsx)(Tn,{show:"plots"===i.sidebar}),Object(bt.jsx)(Bn,{show:"files"===i.sidebar}),Object(bt.jsx)("div",{id:"mv-appwindow",className:"mv-background"}),Object(bt.jsx)(Yt,{}),Object(bt.jsx)("div",{className:"drag-overlay"}),Object(bt.jsx)(qn,{})]})}var Hn=function(){return Object(bt.jsx)("div",{className:"mv-main-app",children:Object(bt.jsx)(Wn,{})})},Zn=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,396)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),s(e),i(e),c(e)}))};c.a.render(Object(bt.jsx)(s.a.StrictMode,{children:Object(bt.jsx)(T.a,{store:ut,children:Object(bt.jsx)(Hn,{})})}),document.getElementById("root")),Zn(console.log)},74:function(e,t,n){}},[[387,1,2]]]);
//# sourceMappingURL=main.01cced66.chunk.js.map